<?xml version="1.0" encoding="UTF-8" standalone="no"?><atlassian-plugin key="com.atlassian.confluence.extra.officeconnector" name="Office Connector plugin" plugins-version="2"><plugin-info><description>Confluence Office Connector</description><version>5.1.1</version><vendor name="Atlassian" url="http://www.atlassian.com/"/><param name="configure.url">/admin/worddav/adminword.action</param><param name="atlassian-data-center-compatible">true</param></plugin-info><analytics-whitelist key="officeConnectorAnalyticsWhitelist" resource="analytics/whitelist.json"/><component key='cacheCleanupJobDetail' name="Cache Cleanup Job Detail" class="com.benryan.quartz.CacheCleanupJobDetail"><description>Component that contains the details of the Cache CleanUp Job</description><interface>org.quartz.JobDetail</interface></component><extractor class="com.atlassian.confluence.extra.officeconnector.index.word.WordTextExtractor" key="wordContentExtractor" name="Word Content Extractor" priority="1099"><description>Indexes contents of Word 97/2007 files</description></extractor><extractor class="com.atlassian.confluence.extra.officeconnector.index.word.WordXMLTextExtractor" key="wordXMLContentExtractor" name="Word XML Content Extractor" priority="1099"><description>Indexes contents of Word XML files</description></extractor><extractor class="com.atlassian.confluence.extra.officeconnector.index.powerpoint.PowerPointTextExtractor" key="ppt97ContentExtractor" name="PowerPoint 97 Content Extractor" priority="1099"><description>Indexes contents of PowerPoint 97 files</description></extractor><extractor class="com.atlassian.confluence.extra.officeconnector.index.powerpoint.PowerPointXMLTextExtractor" key="ppt2k7ContentExtractor" name="PowerPoint 2007 Content Extractor" priority="1099"><description>Indexes contents of PowerPoint 2007 files</description></extractor><extractor class="com.atlassian.confluence.extra.officeconnector.index.excel.ExcelTextExtractor" key="excel97ContentExtractor" name="Excel 97 Content Extractor" priority="1099"><description>Indexes contents of Excel 97 files</description></extractor><extractor class="com.atlassian.confluence.extra.officeconnector.index.excel.ExcelXMLTextExtractor" key="excel2k7ContentExtractor" name="Excel 2007 Content Extractor" priority="1099"><description>Indexes contents of Excel 2007 files</description></extractor><trigger key="cleanupTrigger" name="File Cache Cleanup"><job key="cacheCleanupJobDetail"/><schedule cron-expression="0 0 2 * * ?"/></trigger><resource location="templates/extra/officeconnector" name="i18n" type="i18n"/><resource location="templates/extra/images" name="images/" type="download"/><web-resource key="office-connector-css" name="office-connector.css"><resource location="css/office-connector.css" name="office-connector.css" type="download"/></web-resource><web-resource key="file-viewer-plugin" name="file-viewer-plugin"><transformation extension="js"><transformer key="jsI18n"/></transformation><dependency>com.atlassian.confluence.plugins.confluence-previews:confluence-previews-resources</dependency><resource location="javascript/edit-in-office-plugin.js" name="edit-in-office-plugin.js" type="download"/><context>file-viewer</context><context>media-viewer</context></web-resource><web-item key="worddavadmin" name="Office Connector administration link" section="system.admin/configuration" weight="1000"><label key="office.connector.config"/><link linkId="configure-office-connector">/admin/worddav/adminword.action</link><condition class="com.atlassian.confluence.plugin.descriptor.web.conditions.SystemAdministratorCondition"/><condition class="com.atlassian.confluence.plugin.descriptor.web.conditions.IsConfluenceSpacesLicensedCondition"/></web-item><web-item key="searchpreview" name="Link for previewing a search result" section="system.search/result.primary" weight="1000"><label key="office.connector.viewlink"/><link><![CDATA[/pages/worddav/preview.action?pageId=$searchResult.extraFields.containingContentId&fileName=$generalUtil.urlEncode($searchResult.displayTitle)]]></link><condition class="com.benryan.webwork.util.SearchPreviewFileCondition"/></web-item><web-item key="preview" name="Link for previewing an attachment" section="system.attachment" weight="10"><label key="office.connector.viewlink"/><link><![CDATA[/pages/worddav/preview.action?fileName=$generalUtil.urlEncode($attachment.fileName)&pageId=$page.Id]]></link><condition class="com.benryan.webwork.util.PreviewFileCondition"/></web-item><macro class="com.benryan.conversion.macro.ConverterMacro" hidden="true" key="viewfile-legacy" name="viewfile"><description>Adds a hyperlink for editing in Word</description><resource location="templates/extra/editinword/webdavloader.xpi" name="webdavloader.xpi" type="download"/><resource location="templates/extra/conversion/viewfile-help.vm" name="help" type="velocity"><param name="help-section" value="confluence"/></resource></macro><xhtml-macro name="viewfile" class="com.benryan.conversion.macro.ViewOfficeFile" key="viewfile" hidden="true" documentation-url="help.view.file.macro"><description>Adds a hyperlink for editing in Word</description><category name="confluence-content"/><parameters><parameter name="name" required="true" type="attachment"><alias name=""/></parameter><parameter name="page" type="confluence-content"><option key="includeDatePath" value="true"/></parameter><parameter name="height" type="string"/><parameter name="width" type="string"/><parameter name="slide" type="int"/><parameter default="true" name="grid" type="boolean"/><parameter name="row" type="int"/><parameter name="col" type="int"/><parameter name="sheet" type="string"/></parameters><property-panel><button id="office-connector-download-file-button" label="office.property.panel.button.download"/></property-panel><resource location="templates/extra/editinword/webdavloader.xpi" name="webdavloader.xpi" type="download"/><resource location="templates/extra/conversion/viewfile-help.vm" name="help" type="velocity"><param name="help-section" value="confluence"/></resource></xhtml-macro><macro class="com.benryan.conversion.macro.ConverterMacro" key="viewdoc-legacy" name="viewdoc"><description>Inserts Microsoft Word content into the page</description></macro><xhtml-macro class="com.benryan.conversion.macro.ViewOfficeFile" documentation-url="help.view.file.macro.word" key="viewdoc" name="viewdoc"><description>Inserts Microsoft Word content into the page</description><category name="confluence-content"/><category name="media"/><parameters><parameter name="page" type="confluence-content"><option key="includeDatePath" value="true"/></parameter><parameter name="name" required="true" type="attachment"><alias name=""/></parameter></parameters><property-panel><button id="office-connector-download-file-button" label="office.property.panel.button.download"/></property-panel></xhtml-macro><macro class="com.benryan.conversion.macro.ConverterMacro" key="viewxls-legacy" name="viewxls"><description>Inserts Microsoft Excel content into the page</description></macro><xhtml-macro class="com.benryan.conversion.macro.ViewOfficeFile" documentation-url="help.view.file.macro.excel" key="viewxls" name="viewxls"><description>Inserts Microsoft Excel content into the page</description><category name="confluence-content"/><category name="media"/><parameters><parameter name="page" type="confluence-content"><option key="includeDatePath" value="true"/></parameter><parameter name="name" required="true" type="attachment"><alias name=""/></parameter><parameter default="true" name="grid" type="boolean"/><parameter name="sheet" type="string"/><parameter name="row" type="int"/><parameter name="col" type="int"/></parameters><property-panel><button id="office-connector-download-file-button" label="office.property.panel.button.download"/></property-panel></xhtml-macro><macro class="com.benryan.conversion.macro.ConverterMacro" key="viewppt-legacy" name="viewppt"><description>Inserts an interactive Microsoft Powerpoint presentation into the page</description></macro><xhtml-macro class="com.benryan.conversion.macro.ViewOfficeFile" documentation-url="help.view.file.macro.powerpoint" key="viewppt" name="viewppt"><description>Inserts an interactive Microsoft Powerpoint presentation into the page</description><category name="confluence-content"/><category name="media"/><parameters><parameter name="page" type="confluence-content"><option key="includeDatePath" value="true"/></parameter><parameter name="name" required="true" type="attachment"><alias name=""/></parameter><parameter name="slide" type="int"/><parameter name="height" type="string"/><parameter name="width" type="string"/></parameters><property-panel><button id="office-connector-download-file-button" label="office.property.panel.button.download"/></property-panel></xhtml-macro><macro class="com.benryan.conversion.macro.ConverterMacro" documentation-url="help.view.file.macro.pdf" key="viewpdf-legacy" name="viewpdf"><description>Inserts a PDF document into the page as an interactive presentation</description></macro><xhtml-macro class="com.benryan.conversion.macro.ViewOfficeFile" documentation-url="help.view.file.macro.pdf" key="viewpdf" name="viewpdf"><description>Inserts a PDF document into the page as an interactive presentation</description><category name="confluence-content"/><category name="media"/><parameters><parameter name="page" type="confluence-content"><option key="includeDatePath" value="true"/></parameter><parameter name="name" required="true" type="attachment"><alias name=""/></parameter></parameters><property-panel><button id="office-connector-download-file-button" label="office.property.panel.button.download"/></property-panel></xhtml-macro><macro class="com.benryan.conversion.macro.ConverterMacro" key="editgrid-legacy" name="editgrid" state="disabled"><description>Adds a hyperlink for editing in Word</description><resource location="templates/extra/editinword/webdavloader.xpi" name="webdavloader.xpi" type="download"/><resource location="templates/extra/conversion/viewfile-help.vm" name="help" type="velocity"><param name="help-section" value="confluence"/></resource></macro><web-item key="editattachmentinworditempathauth" name="Edit office document on attachment page (with pathauth)" section="system.attachment" weight="20"><description>Allows editing of Office Documents from Attachments list (with pathauth)</description><label key="office.connector.attachment.edit"/><link>$generalUtil.htmlEncode("${officeVelocityHelper.getWebDavUrl($attachment)}")</link><styleClass>office-editable-pathauth</styleClass><conditions type="AND"><condition class="com.atlassian.confluence.extra.office.webwork.IsOfficeFileAttachment"/><condition class="com.benryan.webwork.util.UsePathAuthCondition"><param name="pathauth">true</param></condition></conditions></web-item><web-item key="editattachmentinworditem" name="Edit office document on attachment page" section="system.attachment" weight="20"><description>Allows editing of Office Documents from Attachments list</description><label key="office.connector.attachment.edit"/><link>$generalUtil.htmlEncode("${officeVelocityHelper.getWebDavUrl($attachment)}")</link><styleClass>office-editable</styleClass><conditions type="AND"><condition class="com.atlassian.confluence.extra.office.webwork.IsOfficeFileAttachment"/><condition class="com.benryan.webwork.util.UsePathAuthCondition"><param name="pathauth">false</param></condition></conditions></web-item><velocity-context-item class="com.atlassian.confluence.extra.office.velocity.VelocityHelper" context-key="officeVelocityHelper" key="velocity.helper" name="Office Connector Velocity Helper"/><web-item key="importworditem" name="Import Word UI on page tabs" section="system.page" weight="40"><label key="office.connector.docimport"/><link linkId="import-word-doc-tab">/pages/worddav/uploadimport.action?pageId=$helper.page.id</link><condition class="com.benryan.webwork.util.LocationCondition"><param name="location">docimport</param></condition></web-item><web-item key="importworditem1" name="Import Word UI on drop down menu" section="system.content.action/secondary" weight="50"><label key="office.connector.docimport"/><link linkId="import-word-doc">/pages/worddav/uploadimport.action?pageId=$helper.page.id</link><condition class="com.benryan.webwork.util.LocationCondition"><param name="location">docimport</param></condition></web-item><web-resource key="editinoffice" name="Edit in Office javascript resource"><resource location="templates/extra/editinword/editInOffice.js" name="editInOffice.js" type="download"/><context>page</context><dependency>confluence.web.resources:jquery</dependency><dependency>confluence.web.resources:ajs</dependency></web-resource><web-resource key="macro-browser-smart-fields" name="Macro Browser Smart Fields"><resource location="javascript/office-connector-macro-fields.js" name="office-connector-macro-fields.js" type="download"/><dependency>confluence.editor.actions:editor-macro-browser</dependency><context>macro-browser</context></web-resource><web-resource key="wordimportresource" name="Word Import javascript resource"><resource location="javascript/word-import.js" name="word-import.js" type="download"/><dependency>confluence.web.resources:jquery</dependency><dependency>confluence.web.resources:ajs</dependency></web-resource><web-resource key="officeconnector-analytics-resources" name="Office Connector Analytics resource"><resource location="analytics/office-connector-analytics.js" name="office-connector-analytics.js" type="download"/><dependency>confluence.web.resources:ajs</dependency></web-resource><web-resource key="officeconnector-editor-resources" name="Office Connector Editor Resources"><resource location="javascript/property-panel.js" name="property-panel.js" type="download"/><dependency>com.atlassian.confluence.tinymceplugin:editor-resources</dependency><context>editor</context></web-resource><web-resource key="slide-viewer-resources" name="Slide viewer Resources"><transformation extension="soy"><transformer key="soyTransformer"><functions>com.atlassian.confluence.plugins.soy:soy-core-functions</functions></transformer></transformation><transformation extension="js"><transformer key="jsI18n"/></transformation><resource location="templates/extra/slideviewer/slideviewer.soy" name="template-slide-viewer.js" type="download"/><resource location="javascript/slide-viewer.js" name="slide-viewer.js" type="download"/><resource location="css/slide-viewer.css" name="slide-viewer.css" type="download"/><dependency>confluence.web.resources:ajs</dependency><dependency>com.atlassian.auiplugin:ajs-backbone</dependency></web-resource><davResourceFactory class="com.benryan.servlet.webdav.EditInWordResourceFactory" key="editInWordResourceFactory" name="Edit In Word WebDAV Resource Factory" workspace="editinword"><description>Exposes Confluence pages and attachments as Word Documents through the Confluence WebDAV plugin. Note: Editing Confluence pages as word documents is not working in Confluence 4.0 (this will log a warning instead).</description></davResourceFactory><servlet-filter class="com.benryan.servlet.PathAuthenticator" key="officeauth" location="before-dispatch" name="Office Authenticator Filter" weight="200"><description>Authenticates http reguests from Office applications</description><url-pattern>/plugins/servlet/*/ocauth/*</url-pattern></servlet-filter><rest key="tokenProvider" path="/office" version="1.0"><description>Provides a REST endpoint to retrieve a temporary auth token to access the webdav server</description></rest><servlet class="com.benryan.conversion.PPTSlideServlet" key="pptslideservlet" name="PPT slide web service"><description>The flex powerpoint viewer uses this as a web service to retrieve slide images</description><url-pattern>/pptslide*</url-pattern><resource location="templates/extra/conversion/" name="conversion/" type="download"/></servlet><servlet class="com.benryan.conversion.HtmlImageServlet" key="htmlslideservlet" name="DOC and XLS image cache web service"><description>Used so the html created from doc and xls conversions can reference cached images instead of attaching them to the page
        </description><url-pattern>/benryanconversion*</url-pattern></servlet><servlet class="com.benryan.servlet.DownloadRedirectServlet" key="downloadInEditor" name="Download File In Editor Servlet"><description>Redirect to the download URL for an attachment identified by the parameters from a "view" macro.</description><url-pattern>/oc/getattachment</url-pattern></servlet><xwork key="wordactions" name="Office Connector Actions"><package extends="default" name="iword" namespace="/pages/worddav"><default-interceptor-ref name="validatingStack"/><action class="com.benryan.webwork.WordImportAction" method="executeFileUpload" name="importword"><result name="error" type="velocity">/templates/extra/editinword/uploadimport.vm</result><result name="input" type="velocity">/templates/extra/editinword/importword.vm</result><result name="success" type="redirect">${viewUrl}</result><result name="warning" type="velocity">/templates/extra/editinword/warning.vm</result></action><action class="com.benryan.webwork.WordImportAction" method="executeFileImport" name="doimportword"><result name="success" type="redirect">${viewUrl}</result><result name="error" type="velocity">/templates/extra/editinword/importword.vm</result><result name="warning" type="velocity">/templates/extra/editinword/warning.vm</result></action><action class="com.benryan.webwork.WordImportAction" method="processWarning" name="processwarn"><result name="success" type="redirect">${viewUrl}</result><result name="input" type="velocity">/templates/extra/editinword/importword.vm</result><result name="error" type="velocity">/templates/extra/editinword/importword.vm</result></action><action class="com.benryan.webwork.AttachmentPreviewAction" name="preview"><result name="success" type="velocity">/templates/extra/conversion/preview.vm</result><result name="input" type="redirect">/fourohfour.action</result></action></package><package extends="default" name="word" namespace="/pages/worddav"><default-interceptor-ref name="validatingStack"/><action class="com.benryan.webwork.WordAction" name="uploadimport"><result name="success" type="velocity">/templates/extra/editinword/uploadimport.vm</result><result name="pagenotpermitted" type="dispatcher">/pages/pagenotpermitted.action</result></action></package><package extends="default" name="aword" namespace="/admin/worddav"><default-interceptor-ref name="validatingStack"/><action class="com.benryan.webwork.WordAdminAction" name="adminword"><result name="success" type="velocity">/templates/extra/editinword/adminword.vm</result></action><action class="com.benryan.webwork.WordAdminAction" method="processSubmit" name="adminwordsubmit"><param name="RequireSecurityToken">true</param><param name="RequireSecurityToken">true</param><result name="success" type="redirect">adminword.action?updated=true</result><result name="error" type="velocity">/templates/extra/editinword/adminword.vm</result></action><action class="com.benryan.webwork.ManageQueueAction" name="managequeue"><result name="success" type="velocity">/templates/extra/editinword/managequeue.vm</result></action><action class="com.benryan.webwork.ManageQueueAction" method="removeFromQueue" name="removefromqueue"><result name="success" type="redirect">managequeue.action</result></action></package></xwork></atlassian-plugin>