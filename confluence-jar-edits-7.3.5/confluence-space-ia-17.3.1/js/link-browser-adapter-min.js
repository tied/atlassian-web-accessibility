(function(a){Confluence.Sidebar.LinkAdapter={setLink:function(d){var c=AJS.Meta.get("context-path");var e=Confluence.unescapeEntities(d.getHtml());var b={spaceKey:AJS.Meta.get("space-key"),resourceId:d.attrs["data-linked-resource-id"],resourceType:d.attrs["data-linked-resource-type"],customTitle:e==d.getDefaultAlias()?"":e,url:d.attrs.href};a.ajax({type:"POST",url:c+"/rest/ia/1.0/link",data:a.toJSON(b),dataType:"json",contentType:"application/json",success:function(f){AJS.Confluence.Sidebar.Configure.QuickLinks.addRow({id:f.id,title:f.title,styleClass:f.styleClass,canHide:f.canHide,hidden:f.hidden})}})},getLink:function(){return Confluence.Link.fromData({attrs:{},body:{isEditable:true,isImage:false,html:"",imgName:"",text:""}})},hijackedLinkBrowser:false,hijackLinkBrowser:function(){var b=Confluence.Sidebar.LinkAdapter;if(!b.hijackedLinkBrowser){b.storeBookmark=AJS.Rte.BookmarkManager.storeBookmark;b.restoreBookmark=AJS.Rte.BookmarkManager.restoreBookmark;AJS.Rte.BookmarkManager.storeBookmark=a.noop;AJS.Rte.BookmarkManager.restoreBookmark=a.noop;b.oldLinkAdapter=Confluence.Editor.LinkAdapter;Confluence.Editor.LinkAdapter=b;b.$oldTabItems=a("#link-browser-tab-items div");b.$oldTabItems.each(function(){AJS.debug("while iterating over tab items: "+a(this));var c=a(this).text();if(c!="search"&&c!="recentlyviewed"&&c!="weblink"){a(this).remove()}});b.hijackedLinkBrowser=true}},releaseLinkBrowser:function(){var b=Confluence.Sidebar.LinkAdapter;if(b.hijackedLinkBrowser){AJS.Rte.BookmarkManager.storeBookmark=b.storeBookmark;AJS.Rte.BookmarkManager.restoreBookmark=b.restoreBookmark;a("#link-browser-tab-items").empty().append(b.$oldTabItems);Confluence.Editor.LinkAdapter=b.oldLinkAdapter;b.hijackedLinkBrowser=false}}};AJS.bind("closed.link-browser",function(){if(Confluence.Sidebar.LinkAdapter.hijackedLinkBrowser){Confluence.Sidebar.LinkAdapter.releaseLinkBrowser()}});AJS.bind("updated.link-browser-recently-viewed",function(){var c=AJS.Meta.get("page-title"),b=AJS.Meta.get("space-name");if(c&&b){a("#insert-link-dialog .recently-viewed-panel .data-table tr").each(function(){var d=a(this);if(d.find(".title-field").text()==c&&d.find(".space-field").text()==b){d.click()}})}})})(AJS.$);