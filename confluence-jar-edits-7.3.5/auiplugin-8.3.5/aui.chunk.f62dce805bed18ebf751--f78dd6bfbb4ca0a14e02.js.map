{"version":3,"sources":["webpack:///../src/js/aui/internal/select/suggestions-view.js","webpack:///../src/js/aui/internal/select/suggestion-model.js","webpack:///../src/js/aui/internal/select/option.js","webpack:///../src/js/aui/internal/select/suggestions-model.js","webpack:///./aui.component.form.single-select.js","webpack:///../src/js/aui/internal/select/template.js","webpack:///../src/js/aui/select.js"],"names":["__webpack_require__","generateListItemID","listId","index","SuggestionsView","element","anchor","this","el","clearActive","_jquery2","default","find","removeClass","prototype","render","suggestions","currentLength","currListId","html","length","i","forEach","sugg","label","getLabel","imageSrc","get","image","newValueText","i18n","getText","querySelector","innerHTML","setActive","active","addClass","getActive","show","view","css","outerWidth","matchWidth","_layer2","_auiAlignment","Alignment","flipContainer","positionFixed","preventOverflow","enable","scheduleUpdate","enableAlignment","hide","disable","disableAlignment","destroy","destroyAlignment","isVisible","is","Backbone","Model","extend","idAttribute","_skate2","created","Object","defineProperty","getAttribute","_escapeHtml2","textContent","set","value","setAttribute","serialize","json","hasAttribute","SuggestionsModel","_suggestions","_activeIndex","onChange","onHighlightChange","oldSuggestions","getNumberOfResults","setHighlighted","toHighlight","id","highlight","highlightPrevious","current","previousActiveIndex","highlightNext","nextActiveIndex","highlighted","highlightedIndex","_skatejsTemplateHtml2","bindSelectMousedown","_constants","_elements","DESELECTED","NO_HIGHLIGHT","DEFAULT_SS_PDS_SIZE","deselect","_select","selectedIndex","_input","removeAttribute","clearElementImage","hasResults","_suggestionModel","waitForAssistive","callback","setTimeout","matchPrefix","model","query","toLowerCase","indexOf","hideDropdown","_suggestionsView","setInitialVisualState","initialHighlightedItem","suggest","autoHighlight","_autoHighlight","undefined","_progressiveDataSet","setInputImageToHighlightedSuggestion","imageSource","setElementImage","setValueAndDisplayFromModel","option","document","createElement","select","options","add","dispatchEvent","CustomEvent","bubbles","selectHighlightedSuggestion","convertOptionToModel","SuggestionModel","convertOptionsToModels","models","_datalist","children","push","getActiveId","_dropdown","getIndexInResults","results","$","map","result","initialiseProgressiveDataSet","ProgressiveDataSet","matcher","queryEndpoint","_queryEndpoint","maxResults","_isSync","on","activeQueryCount","_button","isBusy","busy","setBusyState","_state2","idle","setIdleState","data","optionToHighlight","isInputExactMatch","isInputEmpty","Option","newValueSuggestionModel","createNewValueModel","indexOfValueInResults","splice","clearAndSet","preventClosingContainerLayer","e","preventDefault","target","closest","focusInHandler","searchValue","cancelInProgressQueries","isQueryInProgress","getSelectedLabel","focusOutHandler","selectCanBeEmpty","selectionIsEmpty","selectionNotExact","selection","handleInvalidInputOnFocusOut","handleHighlightOnFocusOut","SelectEl","template","_listId","_uniqueId2","suggestionsToAdd","newSuggestion","some","oldSuggestion","attached","skate","init","associateDropdownAndTrigger","bindHighlightMouseover","initialiseValue","detached","off","ifGone","then","attributes","newValue","INPUT_SUFFIX","name","placeholder","src","events","blur input","mousedown button","activeElement","click input","click button","focus","input","keydown input","currentValue","handled","keyCode","ESCAPE","ENTER","TAB","handleTabOut","UP","DOWN","defaultPrevented","selected","clearValue","findWhere","displayValue","blur","_amdify2","_globalize2"],"mappings":"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","file":"aui.chunk.f62dce805bed18ebf751--f78dd6bfbb4ca0a14e02.js","sourcesContent":["import $ from '../../jquery';\nimport i18n from '../../i18n';\nimport Alignment from '../alignment';\nimport layer from '../../layer';\n\nfunction generateListItemID (listId, index) {\n    return listId + '-' + index;\n}\n\n/**\n *\n * @param view SuggestionsView\n */\nfunction enableAlignment (view) {\n    if (view.anchor && !view._auiAlignment) {\n        view._auiAlignment = new Alignment(view.el, view.anchor, {\n            flipContainer: 'scrollParent',\n            positionFixed: false,\n            preventOverflow: false\n        });\n    }\n\n    if (view._auiAlignment) {\n        view._auiAlignment.enable();\n        view._auiAlignment.scheduleUpdate();\n    }\n}\n\nfunction disableAlignment (view) {\n    if (view._auiAlignment) {\n        view._auiAlignment.disable();\n    }\n}\n\nfunction destroyAlignment (view) {\n    if (view._auiAlignment) {\n        view._auiAlignment.destroy();\n        delete view._auiAlignment;\n    }\n}\n\nfunction matchWidth (view) {\n    $(view.el).css('min-width', $(view.anchor).outerWidth());\n}\n\nfunction SuggestionsView (element, anchor) {\n    this.el = element;\n    this.anchor = anchor;\n}\n\nfunction clearActive (element) {\n    $(element).find('.aui-select-active').removeClass('aui-select-active');\n}\n\nSuggestionsView.prototype = {\n    render: function (suggestions, currentLength, listId) {\n        this.currListId = listId;\n        var html = '';\n\n        // Do nothing if we have no new suggestions, otherwise append anything else we find.\n        if (suggestions.length) {\n            var i = currentLength;\n            suggestions.forEach(function (sugg) {\n                var label = sugg.getLabel();\n                var imageSrc = sugg.get('img-src');\n                var image = imageSrc ? `<img src=\"${imageSrc}\"/>` : '';\n                var newValueText = sugg.get('new-value') ? ` (<em>${i18n.getText('aui.select.new.value')}</em>)` : '';\n                html += `<li role=\"option\" class=\"aui-select-suggestion\" id=\"${generateListItemID(listId, i)}\">${image}${label}${newValueText}</li>`;\n                i++;\n            });\n\n            // If the old suggestions were empty, a <li> of 'No suggestions' will be appended, we need to remove it\n            if (currentLength) {\n                this.el.querySelector('ul').innerHTML += html;\n            } else {\n                this.el.querySelector('ul').innerHTML = html;\n            }\n        } else if (!currentLength) {\n            this.el.querySelector('ul').innerHTML = `<li role=\"option\" class=\"aui-select-no-suggestions\">${i18n.getText('aui.select.no.suggestions')}</li>`;\n        }\n\n        return this;\n    },\n    setActive: function (active) {\n        clearActive(this.el);\n        $(this.el).find('#' + generateListItemID(this.currListId, active)).addClass('aui-select-active');\n    },\n    getActive: function () {\n        return this.el.querySelector('.aui-select-active');\n    },\n    show: function () {\n        matchWidth(this);\n        layer(this.el).show();\n        enableAlignment(this);\n    },\n    hide: function () {\n        clearActive(this.el);\n        layer(this.el).hide();\n        disableAlignment(this);\n    },\n    destroy: function () {\n        this.hide();\n        destroyAlignment(this);\n        delete this.currListId;\n    },\n    isVisible: function () {\n        return $(this.el).is(':visible');\n    }\n};\n\nexport default SuggestionsView;\n","import Backbone from 'backbone';\n\nexport default Backbone.Model.extend({\n    idAttribute: 'label',\n    getLabel: function () {\n        return this.get('label') || this.get('value');\n    }\n});\n","import skate from '../skate';\nimport escapeHtml from '../../escape-html';\n\nexport default skate('aui-option', {\n    created: function (element) {\n        Object.defineProperty(element, 'value', {\n            get: function () {\n                return element.getAttribute('value') || escapeHtml(this.textContent);\n            },\n            set: function (value) {\n                element.setAttribute('value', value);\n            }\n        });\n    },\n    prototype: {\n        serialize: function () {\n            var json = {};\n            if (this.hasAttribute('img-src')) {\n                json['img-src'] = escapeHtml(this.getAttribute('img-src'));\n            }\n            json.value = this.value;\n            json.label = escapeHtml(this.textContent);\n\n            return json;\n        }\n    }\n});\n","\nfunction SuggestionsModel () {\n    this._suggestions = [];\n    this._activeIndex = -1;\n}\n\nSuggestionsModel.prototype = {\n    onChange: function () {},\n\n    onHighlightChange: function () {},\n\n    get: function (index) {\n        return this._suggestions[index];\n    },\n\n    set: function (suggestions) {\n        var oldSuggestions = this._suggestions;\n        this._suggestions = suggestions || [];\n        this.onChange(oldSuggestions);\n        return this;\n    },\n\n    getNumberOfResults: function () {\n        return this._suggestions.length;\n    },\n\n    setHighlighted: function (toHighlight) {\n        if (toHighlight) {\n            for (var i = 0; i < this._suggestions.length; i++) {\n                if (this._suggestions[i].id === toHighlight.id) {\n                    this.highlight(i);\n                }\n            }\n        }\n\n        return this;\n    },\n\n    highlight: function (index) {\n        this._activeIndex = index;\n        this.onHighlightChange();\n        return this;\n    },\n\n    highlightPrevious: function () {\n        var current = this._activeIndex;\n        var previousActiveIndex = (current === 0) ? current : (current - 1);\n        this.highlight(previousActiveIndex);\n        return this;\n    },\n\n    highlightNext: function () {\n        var current = this._activeIndex;\n        var nextActiveIndex = (current === this._suggestions.length - 1) ? current : (current + 1);\n        this.highlight(nextActiveIndex);\n        return this;\n    },\n\n    highlighted: function () {\n        return this.get(this._activeIndex);\n    },\n\n    highlightedIndex: function () {\n        return this._activeIndex;\n    }\n};\n\nexport default SuggestionsModel;\n","import './styles/aui.pattern.forms';\nimport '@atlassian/aui/src/less/single-select.less';\nexport { default as SelectEl } from '@atlassian/aui/src/js/aui/select';\n","import template from 'skatejs-template-html';\n\nexport default template(`\n    <input type=\"text\" class=\"text\" autocomplete=\"off\" role=\"combobox\" aria-autocomplete=\"list\" aria-haspopup=\"true\" aria-expanded=\"false\">\n    <select></select>\n    <datalist>\n        <content select=\"aui-option\"></content>\n    </datalist>\n    <button class=\"aui-button\" role=\"button\" tabindex=\"-1\" type=\"button\"></button>\n    <div class=\"aui-popover\" role=\"listbox\" data-aui-alignment=\"bottom left\">\n        <ul class=\"aui-optionlist\" role=\"presentation\"></ul>\n    </div>\n    <div class=\"aui-select-status assistive\" aria-live=\"polite\" role=\"status\"></div>\n`);\n","import $ from './jquery';\nimport './button';\nimport './spin';\nimport i18n from './i18n';\nimport Option from './internal/select/option';\nimport amdify from './internal/amdify';\nimport CustomEvent from './polyfills/custom-event';\nimport globalize from './internal/globalize';\nimport keyCode from './key-code';\nimport ProgressiveDataSet from './progressive-data-set';\nimport skate from './internal/skate';\nimport state from './internal/state';\nimport SuggestionModel from './internal/select/suggestion-model';\nimport SuggestionsModel from './internal/select/suggestions-model';\nimport SuggestionsView from './internal/select/suggestions-view';\nimport template from './internal/select/template';\nimport uniqueId from './unique-id';\nimport { INPUT_SUFFIX } from './internal/constants';\nimport {ifGone} from \"./internal/elements\";\n\nvar DESELECTED = -1;\nvar NO_HIGHLIGHT = -1;\nvar DEFAULT_SS_PDS_SIZE = 20;\n\nfunction clearElementImage(element) {\n    element._input.removeAttribute('style');\n    $(element._input).removeClass('aui-select-has-inline-image');\n}\n\nfunction deselect(element) {\n    element._select.selectedIndex = DESELECTED;\n    clearElementImage(element);\n}\n\nfunction hasResults(element) {\n    return element._suggestionModel.getNumberOfResults();\n}\n\nfunction waitForAssistive (callback) {\n    setTimeout(callback, 50);\n}\n\nfunction setBusyState (element) {\n    if (!element._button.isBusy()) {\n        element._button.busy();\n        element._input.setAttribute('aria-busy', 'true');\n        element._dropdown.setAttribute('aria-busy', 'true');\n    }\n}\n\nfunction setIdleState (element) {\n    element._button.idle();\n    element._input.setAttribute('aria-busy', 'false');\n    element._dropdown.setAttribute('aria-busy', 'false');\n}\n\nfunction matchPrefix (model, query) {\n    var value = model.get('label').toLowerCase();\n    return value.indexOf(query.toLowerCase()) === 0;\n}\n\nfunction hideDropdown (element) {\n    element._suggestionsView.hide();\n    element._input.setAttribute('aria-expanded', 'false');\n}\n\nfunction setInitialVisualState (element) {\n    var initialHighlightedItem = hasResults(element) ? 0 : NO_HIGHLIGHT;\n\n    element._suggestionModel.highlight(initialHighlightedItem);\n\n    hideDropdown(element);\n}\n\nfunction setElementImage (element, imageSource) {\n    $(element._input).addClass('aui-select-has-inline-image');\n    element._input.setAttribute('style', 'background-image: url(' + imageSource + ')');\n}\n\nfunction suggest (element, autoHighlight, query) {\n    element._autoHighlight = autoHighlight;\n\n    if (query === undefined) {\n        query = element._input.value;\n    }\n\n    element._progressiveDataSet.query(query);\n}\n\nfunction setInputImageToHighlightedSuggestion (element) {\n    var imageSource = (element._suggestionModel.highlighted() && element._suggestionModel.highlighted().get('img-src'));\n    if (imageSource) {\n        setElementImage(element, imageSource);\n    }\n}\n\nfunction setValueAndDisplayFromModel (element, model) {\n    if (!model) {\n        return;\n    }\n\n    var option = document.createElement('option');\n    var select = element._select;\n    var value = model.get('value') || model.get('label');\n\n    option.setAttribute('selected', '');\n    option.setAttribute('value', value);\n    option.textContent = model.getLabel();\n\n    // Sync element value.\n    element._input.value = option.textContent;\n\n    select.innerHTML = '';\n    select.options.add(option);\n    select.dispatchEvent(new CustomEvent('change', {bubbles: true}));\n}\n\nfunction clearValue (element) {\n    element._input.value = '';\n    element._select.innerHTML = '';\n}\n\nfunction selectHighlightedSuggestion (element) {\n    setValueAndDisplayFromModel(element, element._suggestionModel.highlighted());\n    setInputImageToHighlightedSuggestion(element);\n    setInitialVisualState(element);\n}\n\nfunction convertOptionToModel (option) {\n    return new SuggestionModel(option.serialize());\n}\n\nfunction convertOptionsToModels (element) {\n    var models = [];\n\n    for (var i = 0; i < element._datalist.children.length; i++) {\n        var option = element._datalist.children[i];\n        models.push(convertOptionToModel(option));\n    }\n\n    return models;\n}\n\nfunction clearAndSet (element, data) {\n    element._suggestionModel.set();\n    element._suggestionModel.set(data.results);\n}\n\nfunction getActiveId (select) {\n    var active = select._dropdown.querySelector('.aui-select-active');\n    return active && active.id;\n}\n\nfunction getIndexInResults (id, results) {\n    var resultsIds = $.map(results, function (result) {\n        return result.id;\n    });\n\n    return resultsIds.indexOf(id);\n}\n\nfunction createNewValueModel (element) {\n    var option = new Option();\n    option.setAttribute('value', element._input.value);\n    var newValueSuggestionModel = convertOptionToModel(option);\n    newValueSuggestionModel.set('new-value', true);\n    return newValueSuggestionModel;\n}\n\nfunction initialiseProgressiveDataSet (element) {\n    element._progressiveDataSet = new ProgressiveDataSet(convertOptionsToModels(element), {\n        model: SuggestionModel,\n        matcher: matchPrefix,\n        queryEndpoint: element._queryEndpoint,\n        maxResults: DEFAULT_SS_PDS_SIZE\n    });\n\n    element._isSync = !element._queryEndpoint;\n\n    // Progressive data set should indicate whether or not it is busy when processing any async requests.\n    // Check if there's any active queries left, if so: set spinner and state to busy, else set to idle and remove\n    // the spinner.\n    element._progressiveDataSet.on('activity', function () {\n        if (element._progressiveDataSet.activeQueryCount && !element._isSync) {\n            setBusyState(element);\n            state(element).set('should-flag-new-suggestions', false);\n        } else {\n            setIdleState(element);\n            state(element).set('should-flag-new-suggestions', true);\n        }\n    });\n\n    // Progressive data set doesn't do anything if the query is empty so we\n    // must manually convert all data list options into models.\n    //\n    // Otherwise progressive data set can do everything else for us:\n    // 1. Sync matching\n    // 2. Async fetching and matching\n    /* eslint-disable complexity */\n    element._progressiveDataSet.on('respond', function (data) {\n        var optionToHighlight;\n\n        // This means that a query was made before the input was cleared and\n        // we should cancel the response.\n        if (data.query && !element._input.value) {\n            return;\n        }\n\n        if (state(element).get('should-cancel-response')) {\n            if (!element._progressiveDataSet.activeQueryCount) {\n                state(element).set('should-cancel-response', false);\n            }\n\n            return;\n        }\n\n        if (!data.query) {\n            data.results = convertOptionsToModels(element);\n        }\n\n        var isInputExactMatch = getIndexInResults(element._input.value, data.results) !== -1;\n        var isInputEmpty = !element._input.value;\n\n        if (element.hasAttribute('can-create-values') && !isInputExactMatch && !isInputEmpty) {\n            data.results.push(createNewValueModel(element));\n        }\n\n        if (!state(element).get('should-include-selected')) {\n            var indexOfValueInResults = getIndexInResults(element.value, data.results);\n\n            if (indexOfValueInResults >= 0) {\n                data.results.splice(indexOfValueInResults, 1);\n            }\n        }\n\n        clearAndSet(element, data);\n        optionToHighlight = element._suggestionModel.highlighted() || data.results[0];\n\n        if (element._autoHighlight) {\n            element._suggestionModel.setHighlighted(optionToHighlight);\n            waitForAssistive(function () {\n                element._input.setAttribute('aria-activedescendant', getActiveId(element));\n            });\n        }\n\n        element._input.setAttribute('aria-expanded', 'true');\n\n        // If the response is async (append operation), has elements to append and has a highlighted element, we need to update the status.\n        if (!element._isSync && element._suggestionsView.getActive() && state(element).get('should-flag-new-suggestions')) {\n            element.querySelector('.aui-select-status').innerHTML = i18n.getText('aui.select.new.suggestions');\n        }\n\n        element._suggestionsView.show();\n\n        if (element._autoHighlight) {\n            waitForAssistive(function () {\n                element._input.setAttribute('aria-activedescendant', getActiveId(element));\n            });\n        }\n    });\n}\n\nfunction associateDropdownAndTrigger (element) {\n    element._dropdown.id = element._listId;\n    element.querySelector('button').setAttribute('aria-controls', element._listId);\n}\n\nfunction bindHighlightMouseover (element) {\n    $(element._dropdown).on('mouseover', 'li', function (e) {\n        if (hasResults(element)) {\n            element._suggestionModel.highlight($(e.target).index());\n        }\n    });\n}\n\nexport function bindSelectMousedown (element) {\n    let preventClosingContainerLayer = false;\n\n    $(document).on('aui-close-layers-on-outer-click.single-select', e => {\n        if (preventClosingContainerLayer) {\n            e.preventDefault();\n            preventClosingContainerLayer = false;\n        }\n    });\n\n    $(element._dropdown).on('mousedown', 'li', function (e) {\n        if (hasResults(element)) {\n            element._suggestionModel.highlight($(e.target).index());\n            selectHighlightedSuggestion(element);\n\n            element._suggestionsView.hide();\n\n            if ($(element).closest('.aui-layer').length > 0) {\n                preventClosingContainerLayer = true;\n            }\n\n            element._input.removeAttribute('aria-activedescendant');\n        } else {\n            return false;\n        }\n    });\n}\n\nfunction initialiseValue (element) {\n    var option = element._datalist.querySelector('aui-option[selected]');\n\n    if (option) {\n        setValueAndDisplayFromModel(element, convertOptionToModel(option));\n    }\n}\n\nfunction isQueryInProgress (element) {\n    return element._progressiveDataSet.activeQueryCount > 0;\n}\n\nfunction focusInHandler (element) {\n    //if there is a selected value the single select should do an empty\n    //search and return everything\n    var searchValue = element.value ? '' : element._input.value;\n    var isInputEmpty = element._input.value === '';\n    state(element).set('should-include-selected', isInputEmpty);\n    suggest(element, true, searchValue);\n}\n\nfunction cancelInProgressQueries (element) {\n    if (isQueryInProgress(element)) {\n        state(element).set('should-cancel-response', true);\n    }\n}\n\nfunction getSelectedLabel(element) {\n    if (element._select.selectedIndex >= 0) {\n        return element._select.options[element._select.selectedIndex].textContent;\n    }\n}\n\nfunction handleInvalidInputOnFocusOut (element) {\n    var selectCanBeEmpty = !element.hasAttribute('no-empty-values');\n    var selectionIsEmpty = !element._input.value;\n    var selectionNotExact = element._input.value !== getSelectedLabel(element);\n    var selectionNotValid = selectionIsEmpty || selectionNotExact;\n\n    if (selectionNotValid) {\n        if (selectCanBeEmpty) {\n            deselect(element);\n        } else {\n            var selection = getSelectedLabel(element);\n            if (typeof selection === 'undefined') {\n                deselect(element);\n            } else {\n                element._input.value = selection;\n            }\n        }\n    }\n}\n\nfunction handleHighlightOnFocusOut(element) {\n    // Forget the highlighted suggestion.\n    element._suggestionModel.highlight(NO_HIGHLIGHT);\n}\n\nfunction focusOutHandler (element) {\n    cancelInProgressQueries(element);\n    handleInvalidInputOnFocusOut(element);\n    handleHighlightOnFocusOut(element);\n    hideDropdown(element);\n}\n\nfunction handleTabOut (element) {\n    var isSuggestionViewVisible = element._suggestionsView.isVisible();\n    if (isSuggestionViewVisible) {\n        selectHighlightedSuggestion(element);\n    }\n}\n\nconst SelectEl = skate('aui-select', {\n    template: template,\n    created: function (element) {\n        element._listId = uniqueId();\n        element._input = element.querySelector('input');\n        element._select = element.querySelector('select');\n        element._dropdown = element.querySelector('.aui-popover');\n        element._datalist = element.querySelector('datalist');\n        element._button = element.querySelector('button');\n        element._suggestionsView = new SuggestionsView(element._dropdown, element._input);\n        element._suggestionModel = new SuggestionsModel();\n\n        element._suggestionModel.onChange = function (oldSuggestions) {\n            var suggestionsToAdd = [];\n\n            element._suggestionModel._suggestions.forEach(function (newSuggestion) {\n                var inArray = oldSuggestions.some(function (oldSuggestion) {\n                    return newSuggestion.id === oldSuggestion.id;\n                });\n\n                if (!inArray) {\n                    suggestionsToAdd.push(newSuggestion);\n                }\n            });\n\n            element._suggestionsView.render(suggestionsToAdd, oldSuggestions.length, element._listId);\n        };\n\n        element._suggestionModel.onHighlightChange = function () {\n            var active = element._suggestionModel.highlightedIndex();\n            element._suggestionsView.setActive(active);\n            element._input.setAttribute('aria-activedescendant', getActiveId(element));\n        };\n    },\n\n    attached: function (element) {\n        skate.init(element);\n        initialiseProgressiveDataSet(element);\n        associateDropdownAndTrigger(element);\n        element._input.setAttribute('aria-controls', element._listId);\n        element.setAttribute('tabindex', '-1');\n        bindHighlightMouseover(element);\n        bindSelectMousedown(element);\n        initialiseValue(element);\n        setInitialVisualState(element);\n        setInputImageToHighlightedSuggestion(element);\n    },\n\n    detached: function (element) {\n        $(document).off('aui-close-layers-on-outer-click');\n        ifGone(element).then(() => {\n            hideDropdown(element);\n            element._suggestionsView.destroy();\n        });\n    },\n\n    attributes: {\n        id(element, data) {\n            if (element.id) {\n                element.querySelector('input').id = data.newValue + INPUT_SUFFIX;\n            }\n        },\n\n        name(element, data) {\n            element.querySelector('select').setAttribute('name', data.newValue);\n        },\n\n        placeholder(element, data) {\n            element.querySelector('input').setAttribute('placeholder', data.newValue);\n        },\n\n        src(element, data) {\n            element._queryEndpoint = data.newValue;\n        }\n    },\n\n    events: {\n        'blur input': function (element) {\n            focusOutHandler(element);\n        },\n\n        'mousedown button': function (element) {\n            if (document.activeElement === element._input && element._dropdown.getAttribute('aria-hidden') === 'false') {\n                state(element).set('prevent-open-on-button-click', true);\n            }\n        },\n\n        'click input': function (element) {\n            focusInHandler(element);\n        },\n\n        'click button': function (element) {\n            var data = state(element);\n\n            if (data.get('prevent-open-on-button-click')) {\n                data.set('prevent-open-on-button-click', false);\n            } else {\n                state(element).set('button-clicked-prevent-dropdown-hide', true);\n                element.focus();\n            }\n        },\n\n        input: function (element) {\n            if (!element._input.value) {\n                if (state(element).get('button-clicked-prevent-dropdown-hide')) {\n                    state(element).set('button-clicked-prevent-dropdown-hide', false);\n                } else {\n                    hideDropdown(element);\n                }\n            } else {\n                state(element).set('should-include-selected', true);\n                suggest(element, true);\n            }\n        },\n\n        'keydown input': function (element, e) {\n            var currentValue = element._input.value;\n            var handled = false;\n\n            if (e.keyCode === keyCode.ESCAPE) {\n                cancelInProgressQueries(element);\n                hideDropdown(element);\n                return;\n            }\n\n            var isSuggestionViewVisible = element._suggestionsView.isVisible();\n\n            if (isSuggestionViewVisible && hasResults(element)) {\n                if (e.keyCode === keyCode.ENTER) {\n                    cancelInProgressQueries(element);\n                    selectHighlightedSuggestion(element);\n                    e.preventDefault();\n                } else if (e.keyCode === keyCode.TAB) {\n                    handleTabOut(element);\n                    handled = true;\n                } else if (e.keyCode === keyCode.UP) {\n                    element._suggestionModel.highlightPrevious();\n                    e.preventDefault();\n                } else if (e.keyCode === keyCode.DOWN) {\n                    element._suggestionModel.highlightNext();\n                    e.preventDefault();\n                }\n            } else if (e.keyCode === keyCode.UP || e.keyCode === keyCode.DOWN) {\n                focusInHandler(element);\n                e.preventDefault();\n            }\n\n            handled = handled || e.defaultPrevented;\n            setTimeout(function emulateCrossBrowserInputEvent () {\n                if (element._input.value !== currentValue && !handled) {\n                    element.dispatchEvent(new CustomEvent('input', {bubbles: true}));\n                }\n            }, 0);\n        }\n    },\n\n    prototype: {\n        get value () {\n            var selected = this._select.options[this._select.selectedIndex];\n            return selected ? selected.value : '';\n        },\n\n        set value (value) {\n            if (value === '') {\n                clearValue(this);\n            } else if (value) {\n                var data = this._progressiveDataSet;\n                var model = data.findWhere({ value }) || data.findWhere({ label: value });\n\n                // Create a new value if allowed and the value doesn't exist.\n                if (!model && this.hasAttribute('can-create-values')) {\n                    model = new SuggestionModel({value: value, label: value});\n                }\n\n                setValueAndDisplayFromModel(this, model);\n            }\n            return this;\n        },\n\n        get displayValue () {\n            return this._input.value;\n        },\n\n        blur: function () {\n            this._input.blur();\n            focusOutHandler(this);\n            return this;\n        },\n\n        focus: function () {\n            this._input.focus();\n            focusInHandler(this);\n            return this;\n        }\n    }\n});\n\namdify('aui/select', SelectEl);\nglobalize('select', SelectEl);\nexport default SelectEl;\n"],"sourceRoot":""}