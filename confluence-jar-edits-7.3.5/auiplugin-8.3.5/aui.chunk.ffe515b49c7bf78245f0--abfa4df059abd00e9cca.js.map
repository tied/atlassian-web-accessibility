{"version":3,"sources":["webpack:///../src/js/aui/header.js","webpack:///../src/js/aui/internal/header/create-header.js","webpack:///./aui.component.async-header.js","webpack:///../src/js/aui/header-async.js"],"names":["__webpack_require__","deprecate","findAndCreateHeaders","_jquery2","default","each","_createHeader2","this","responsiveheader","setup","fn","removeInVersion","sinceVersion","extraInfo","_globalize2","$window","window","Header","element","that","$element","index","$secondaryNav","find","first","menuItems","totalWidth","$moreMenu","undefined","rightMostNavItemIndex","$applicationLogo","moreMenuWidth","primaryButtonsWidth","$headerFind","$header","querySelector","selector","prototype","init","setAttribute","parent","outerWidth","$this","push","length","on","_resizeHandler","_debounce2","constructResponsiveDropdown","$logoImg","attr","css","destroy","off","calculateAvailableWidth","is","offset","left","showResponsiveDropdown","createResponsiveDropdownTrigger","hideResponsiveDropdown","remainingWidth","availableWidth","showAll","newRightMostNavItemIndex","moveToResponsiveDropdown","moveOutOfResponsiveDropdown","moreNavItemEl","document","createElement","dropdownEl","id","skate","dropdownSectionEl","template","wrap","appendChild","triggerEl","dropdown","trigger","innerHTML","i18n","getText","createTriggerAndAssociate","append","before","numItems","$moreDropdown","leftMostIndexToMove","rightMostIndexToMove","i","$navItem","$navItemTrigger","children","$navItemDropdown","getElementById","removeClass","remove","insertBefore","moreDropdownSectionEl","moreDropdownItemEl","addClass","appendTo","textContent","text","detach","firstChild","dispatchEvent","CustomEvent","bubbles","detail","originalItem","newItem","header","_header","_skate2","type","CLASSNAME","created"],"mappings":"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","file":"aui.chunk.ffe515b49c7bf78245f0--abfa4df059abd00e9cca.js","sourcesContent":["import $ from './jquery';\nimport createHeader from './internal/header/create-header';\nimport * as deprecate from './internal/deprecation';\nimport globalize from './internal/globalize';\n\nfunction findAndCreateHeaders () {\n    $('.aui-header').each(function () {\n        createHeader(this);\n    });\n}\n\n$(findAndCreateHeaders);\n\nconst responsiveheader = {};\nresponsiveheader.setup = deprecate.fn(findAndCreateHeaders, 'responsiveheader.setup', {\n    removeInVersion: '9.0.0',\n    sinceVersion: '5.8.0',\n    extraInfo: 'No need to manually initialise anymore as this is now a web component.'\n});\n\nglobalize('responsiveheader', responsiveheader);\n\nexport default responsiveheader;\n","import $ from '../../jquery';\nimport CustomEvent from '../../polyfills/custom-event';\nimport debounce from '../../debounce';\nimport i18n from '../../i18n';\nimport skate from '../skate';\nimport template from 'skatejs-template-html';\n\nconst $window = $(window);\n\nfunction Header (element) {\n    var that = this;\n\n    this.element = element;\n    this.$element = $(element);\n    this.index = $('aui-header, .aui-header').index(element);\n    this.$secondaryNav = this.$element.find('.aui-header-secondary .aui-nav').first();\n    this.menuItems = [];\n    this.totalWidth = 0;\n    this.$moreMenu = undefined;\n    this.rightMostNavItemIndex = undefined;\n    this.$applicationLogo = this.$element.find('#logo');\n    this.moreMenuWidth = 0;\n    this.primaryButtonsWidth = 0;\n\n    // to cache the selector and give .find convenience\n    this.$headerFind = (function () {\n        var $header = $(that.$element[0].querySelector('.aui-header-primary'));\n\n        return function (selector) {\n            return $header.find(selector);\n        };\n    }());\n}\n\nHeader.prototype = {\n    init: function () {\n        var that = this;\n\n        this.element.setAttribute('data-aui-responsive', 'true');\n        this.$headerFind('.aui-button').parent().each(function () {\n            that.primaryButtonsWidth += $(this).outerWidth(true);\n        });\n\n        // remember the widths of all the menu items\n        this.$headerFind('.aui-nav > li > a:not(.aui-button)').each(function () {\n            var $this = $(this).parent();\n            var outerWidth = $this.outerWidth(true);\n\n            that.totalWidth += outerWidth;\n            that.menuItems.push({\n                $element: $this,\n                outerWidth: outerWidth\n            });\n        });\n\n        /** The zero based index of the right-most visible nav menu item. */\n        this.rightMostNavItemIndex = this.menuItems.length - 1;\n\n        $window.on('resize', this._resizeHandler = debounce(function () {\n            that.constructResponsiveDropdown();\n        }, 100));\n\n        // So that the header logo doesn't mess things up. (size is unknown before the image loads)\n        var $logoImg = this.$applicationLogo.find('img');\n\n        if ($logoImg.length !== 0) {\n            $logoImg.attr('data-aui-responsive-header-index', this.index);\n            $logoImg.on('load', function () {\n                that.constructResponsiveDropdown();\n            });\n        }\n\n        this.constructResponsiveDropdown();\n\n        // show the aui nav (hidden via css on load)\n        this.$headerFind('.aui-nav').css('width', 'auto');\n    },\n\n    destroy: function () {\n        $window.off('resize', this._resizeHandler);\n    },\n\n    // calculate widths based on the current state of the page\n    calculateAvailableWidth: function () {\n        // if there is no secondary nav, use the right of the screen as the boundary instead\n        var rightMostBoundary = this.$secondaryNav.is(':visible') ? this.$secondaryNav.offset().left : this.$element.outerWidth();\n\n        // the right most side of the primary nav, this is assumed to exists if this code is running\n        var primaryNavRight = this.$applicationLogo.offset().left + this.$applicationLogo.outerWidth(true) + this.primaryButtonsWidth;\n\n        return rightMostBoundary - primaryNavRight;\n    },\n\n    showResponsiveDropdown: function () {\n        if (this.$moreMenu === undefined) {\n            this.$moreMenu = this.createResponsiveDropdownTrigger();\n        }\n        this.$moreMenu.css('display', '');\n    },\n\n    hideResponsiveDropdown: function () {\n        if (this.$moreMenu !== undefined) {\n            this.$moreMenu.css('display', 'none');\n        }\n    },\n\n    constructResponsiveDropdown: function () {\n        if (!this.menuItems.length) {\n            return;\n        }\n\n        var remainingWidth;\n        var availableWidth = this.calculateAvailableWidth(this.$element, this.primaryButtonsWidth);\n\n        if (availableWidth > this.totalWidth) {\n            this.showAll();\n        } else {\n            this.showResponsiveDropdown();\n            remainingWidth = availableWidth - this.moreMenuWidth;\n\n            // Figure out how many nav menu items fit into the available space.\n            var newRightMostNavItemIndex = -1;\n            while (remainingWidth - this.menuItems[newRightMostNavItemIndex + 1].outerWidth >= 0) {\n                remainingWidth -= this.menuItems[newRightMostNavItemIndex + 1].outerWidth;\n                newRightMostNavItemIndex++;\n            }\n\n            if (newRightMostNavItemIndex < this.rightMostNavItemIndex) {\n                this.moveToResponsiveDropdown(this.rightMostNavItemIndex - newRightMostNavItemIndex);\n            } else if (this.rightMostNavItemIndex < newRightMostNavItemIndex) {\n                this.moveOutOfResponsiveDropdown(newRightMostNavItemIndex - this.rightMostNavItemIndex);\n            }\n        }\n    },\n\n    // creates the trigger and content elements for the show more dropdown\n    createResponsiveDropdownTrigger: function () {\n        var moreNavItemEl = document.createElement('li');\n        var dropdownEl = document.createElement('aui-dropdown-menu');\n        dropdownEl.id = `aui-responsive-header-dropdown-${this.index}`;\n        skate.init(dropdownEl);\n\n        var dropdownSectionEl = document.createElement('aui-section');\n        dropdownSectionEl.id = `aui-responsive-header-dropdown-list-${this.index}`;\n        skate.init(dropdownSectionEl);\n\n        template.wrap(dropdownEl).appendChild(dropdownSectionEl);\n\n        var triggerEl = createTriggerAndAssociate(dropdownEl);\n        moreNavItemEl.appendChild(triggerEl);\n        moreNavItemEl.appendChild(dropdownEl);\n\n        // Append the More menu before any primary buttons.\n        if (this.primaryButtonsWidth === 0) {\n            this.$headerFind('.aui-nav').append(moreNavItemEl);\n        } else {\n            this.$headerFind('.aui-nav > li > .aui-button:first').parent().before(moreNavItemEl);\n        }\n\n        this.moreMenuWidth = $(moreNavItemEl).outerWidth(true);\n        return $(moreNavItemEl);\n    },\n\n    // function that handles moving items out of the show more menu into the app header\n    moveOutOfResponsiveDropdown: function (numItems) {\n        if (numItems <= 0) {\n            return;\n        }\n\n        var $moreDropdown = $(`#aui-responsive-header-dropdown-${this.index}`);\n\n        // Move items (working top-to-bottom) from the more menu into the nav bar.\n        var leftMostIndexToMove = this.rightMostNavItemIndex + 1;\n        var rightMostIndexToMove = this.rightMostNavItemIndex + numItems;\n        for (var i = leftMostIndexToMove; i <= rightMostIndexToMove; i++) {\n            var $navItem = this.menuItems[i].$element;\n            var $navItemTrigger = $navItem.children('a');\n\n            if ($navItemTrigger.attr('aria-controls')) {\n                var $navItemDropdown = $(document.getElementById($navItemTrigger.attr('aria-controls')));\n                $navItemDropdown.removeClass('aui-dropdown2-sub-menu');\n                $navItem.append($navItemDropdown);\n            }\n\n            $moreDropdown.find('aui-item-link:first').remove();\n            $navItem.insertBefore(this.$moreMenu);\n        }\n\n        this.rightMostNavItemIndex += numItems;\n    },\n\n    // function that handles moving items into the show more menu\n    moveToResponsiveDropdown: function (numItems) {\n        if (numItems <= 0) {\n            return;\n        }\n\n        var moreDropdownSectionEl = template.wrap(this.$moreMenu[0].querySelector('aui-section'));\n\n        // Move items (working right-to-left) from the nav bar to the more menu.\n        var rightMostIndexToMove = this.rightMostNavItemIndex;\n        var leftMostIndexToMove = this.rightMostNavItemIndex - numItems + 1;\n        for (var i = rightMostIndexToMove; i >= leftMostIndexToMove; i--) {\n            var $navItem = this.menuItems[i].$element;\n            var $navItemTrigger = $navItem.children('a');\n            skate.init($navItemTrigger); // ensure all triggers have gone through their lifecycle before we check for submenus\n\n            var moreDropdownItemEl = document.createElement('aui-item-link');\n            moreDropdownItemEl.setAttribute('href', $navItemTrigger.attr('href'));\n            if ($navItemTrigger.attr('aria-controls')) {\n                var $navItemDropdown = $(document.getElementById($navItemTrigger.attr('aria-controls')));\n                moreDropdownItemEl.setAttribute('for', $navItemTrigger.attr('aria-controls'));\n                $navItemDropdown.addClass('aui-dropdown2-sub-menu');\n                $navItemDropdown.appendTo('body');\n            }\n            skate.init(moreDropdownItemEl);\n            template.wrap(moreDropdownItemEl).textContent = $navItemTrigger.text();\n\n            $navItem.detach();\n            moreDropdownSectionEl.insertBefore(moreDropdownItemEl, moreDropdownSectionEl.firstChild);\n            this.element.dispatchEvent(new CustomEvent('aui-responsive-menu-item-created', {\n                bubbles: true,\n                detail: {\n                    originalItem: $navItem[0],\n                    newItem: moreDropdownItemEl\n                }\n            }));\n        }\n\n        this.rightMostNavItemIndex -= numItems;\n    },\n\n    // function that handles show everything\n    showAll: function () {\n        this.moveOutOfResponsiveDropdown((this.menuItems.length - 1) - this.rightMostNavItemIndex);\n        this.hideResponsiveDropdown();\n    }\n};\n\nfunction createTriggerAndAssociate(dropdown) {\n    var trigger = document.createElement('a');\n    trigger.setAttribute('class', 'aui-dropdown2-trigger');\n    trigger.setAttribute('href', '#');\n    trigger.id = dropdown.id + '-trigger';\n    trigger.setAttribute('aria-controls', dropdown.id);\n    trigger.innerHTML = i18n.getText('aui.words.more');\n\n    return trigger;\n}\n\n/**\n * Initialise a Header, or return an existing Header for an element.\n */\nfunction createHeader (element) {\n    let header = element._header;\n    if (!(header instanceof Header)) {\n        header = new Header(element);\n        header.init();\n        element._header = header;\n    }\n    return header;\n}\n\nexport default createHeader;\n","import './aui.component.static-header';\nimport './aui.component.trigger';\nimport './aui.component.dropdown2';\nimport '@atlassian/aui/src/less/aui-header-responsive.less';\nimport '@atlassian/aui/src/js/aui/header.js';\nexport { default as Header } from '@atlassian/aui/src/js/aui/header-async';\n","import createHeader from './internal/header/create-header';\nimport skate from './internal/skate';\n\nconst Header = skate('aui-header', {\n    type: skate.type.CLASSNAME,\n    created: function (element) {\n        createHeader(element);\n    }\n});\n\nexport default Header;\n"],"sourceRoot":""}