AJS.$(function(b){var a=AJS.contextPath();var c=AJS.I18n.getText("confluence.extra.attachments.error.spaceattachmenterror");b(".space-attachments").each(function(){var g=b(this);var d={};b("fieldset input[class='param']",g).each(function(){d[this.name]=this.value});g.data("spaceAttachmentsCacheData",d);b(".spaceAttachmentsPage",g).live("click",function(){var i=b(this);var h=i.attr("clickedPage");d.pageNumber=h;f();return false});b(".spaceAttachmentsSortBy",g).live("click",function(){var h=b(this);var i=h.attr("sortBy");d.sortBy=i;d.pageNumber=1;f();return false});b(".removeFilterLink",g).live("click",function(){d.fileExtension="";d.labelFilter="";d.pageNumber=1;f();return false});b(".filterButton",g).live("click",function(){var h=b("input[name='fileExtensionType']",g).val();var i=b("input[name='labelFilter']",g).val();e(h,i)});b(".fileExtensionType",g).live("keydown",function(h){if(h.keyCode=="13"){var j=b("input[name='labelFilter']",g).val();var i=b("input[name='fileExtensionType']",g).val();e(i,j)}});b(".labelFilter",g).live("keydown",function(h){if(h.keyCode=="13"){var j=b("input[name='labelFilter']",g).val();var i=b("input[name='fileExtensionType']",g).val();e(i,j)}});var e=function(i,h){d.fileExtension=i;d.labelFilter=h;d.pageNumber=1;f();return false};var f=function(){b.ajax({cache:false,data:g.data("spaceAttachmentsCacheData"),dataType:"html",success:function(h){var i=b(h);b(".attachments-container",g).replaceWith(i.find(".attachments-container"));AJS.Labels.bindOpenDialog(AJS.$(".show-labels-editor",b(".attachments-container")))},error:function(h,j,i){AJS.log("Error retrieving space attachments: "+i);b(".attachments-container",g).remove();g.append('<div class="space-attachments-error error">'+c+"</div>")},type:"GET",url:a+"/pages/plugins/attachments/space-attachments.action"})}})});