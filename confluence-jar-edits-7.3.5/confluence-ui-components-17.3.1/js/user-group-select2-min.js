define("confluence-ui-components/js/user-group-select2",["ajs","confluence-ui-components/js/internal/soy-templates","jquery"],function(b,a,c){function d(f){f=f||document.body;var e=function(){var g=c(".select2-drop-active > .select2-results");if(g.children(".select2-result-selectable").length===0&&g.children(".select2-disabled").length){g.append('<li class="select2-no-results">'+b.escapeHtml(b.I18n.getText("usersearch.no.results"))+"</li>")}};c("input.autocomplete-multiusergroup[data-autocomplete-bound != 'true']",f).each(function(){var g=c(this);g.attr("data-autocomplete-bound","true");var h=g.attr("data-include-groups");g.auiSelect2({multiple:true,minimumInputLength:2,formatInputTooShort:function(){return h?b.I18n.getText("confluence-ui-components.user-group-select2.usergroup.prompt"):b.I18n.getText("confluence-ui-components.user-group-select2.user.prompt")},ajax:{transport:function(l){var m=l.success;delete l.success;return c.ajax.apply(c.ajax,arguments).done(m).done(e)},data:function(l){return{"max-results":6,query:l}},dataType:"json",url:b.contextPath()+"/rest/prototype/1/search/user"+(h?"-or-group":"")+".json",results:function(m){var l=[];c.each(m.result,function(){if(this.type==="user"){l.push({id:this.username,text:this.title,imgSrc:this.thumbnailLink.href,entity:this})}else{l.push({id:this.name,text:this.name,imgSrc:b.contextPath()+"/images/icons/avatar_group_48.png",entity:this})}});return{results:l}},quietMillis:300},formatResult:function(l){return a.UserGroupSelect2().avatarWithName({size:"small",displayName:l.text,userId:l.id,avatarImageUrl:l.imgSrc})},escapeMarkup:function(l){return l},formatSelection:function(l){return a.UserGroupSelect2().avatarWithName({size:"xsmall",displayName:l.text,userId:l.id,avatarImageUrl:l.imgSrc})},dropdownCssClass:"users-dropdown",containerCssClass:"users-autocomplete",hasAvatar:true});if(!g.data("autofill-user")){return}var k=b.Meta.get("remote-user");var j=b.Meta.get("current-user-fullname");var i=b.Meta.get("current-user-avatar-uri-reference");if(k&&j&&i){g.auiSelect2("data",[{id:k,text:j,imgSrc:i}])}})}return{bind:d}});