define("confluence-keyboard-shortcuts/confluence-keyboard-shortcuts","ajs jquery confluence/legacy window confluence/api/event confluence/api/logger confluence/api/constants".split(" "),function(e,c,a,j,f,i,l){var h={createShortcutFunc:function(b){switch(b.op){case "click":return function(){c(b.param).click()};case "execute":return b.param}},normalizeShortcutKeys:function(b,a){var d=b.toLowerCase();return a.isMac&&a.majorVersion==="4"?d.replace(/ctrl/g,"meta"):d},isAnyShortcutInEvent:function(b,a){return a.some(function(a){var g=
1;b.metaKey&&g++;b.shiftKey&&g++;return a.split("+").every(function(a){g--;return h._isKeyInShortcutString(b,a)})&&g===0})},_isKeyInShortcutString:function(a,c){var d=a.keyCode?a.keyCode:a.which,d=d?String.fromCharCode(d).toLowerCase():"",g=!!(c==="shift"&&a.shiftKey);return!(!(c==="meta"||c==="ctrl")||!a.metaKey)||g||c===d}},k={init:function(){i.debug("confluence-keyboard-shortcuts initialising");if(e.PageGadget||j.parent.AJS&&j.parent.AJS.PageGadget)i.debug("Inside the Page Gadget. Skipping keyboard shortcuts");
else{a.KeyboardShortcuts.enabled=e.Meta.getBoolean("use-keyboard-shortcuts");f.bind("shortcuts-loaded.keyboardshortcuts",function(b,e){a.KeyboardShortcuts.shortcuts=e.shortcuts;c("#keyboard-shortcuts-link").click(a.KeyboardShortcuts.openDialog)});f.bind("init.rte",function(){typeof l.CONTEXT_PATH!=="undefined"&&f.trigger("initialize.keyboardshortcuts")});f.bind("register-contexts.keyboardshortcuts",function(b,e){if(a.KeyboardShortcuts.enabled){var d=e.shortcutRegistry;d.enableContext("global");var g=
a&&a.Editor&&a.Editor.isVisible&&a.Editor.isVisible();c("#action-menu-link").length&&!g&&d.enableContext("viewcontent");c("#viewPageLink").length&&d.enableContext("viewinfo");if(!g)return a.KeyboardShortcuts.ready=true;d.enableContext("editor");var f=require("tinymce"),j=f.activeEditor,k=c("#rte").closest("form");a.KeyboardShortcuts.shortcuts.filter(function(a){return a.context.indexOf("tinymce")===0}).forEach(function(a){a.keys.forEach(function(b){var c=h.createShortcutFunc(a);c||i.logError("ERROR: unkown editor shortcut key operation "+
a.op+" for shortcut "+b);var d=(Array.isArray(b)?b:[b]).map(function(a){return h.normalizeShortcutKeys(a,f)}),b=h.normalizeShortcutKeys(d.join(","),f);i.debug("Adding shortcut for "+b);j.addShortcut(b,"",c);if(a.context=="tinymce.actions"&&b.indexOf("+")!==-1){i.debug("Binding shortcut on inputs too for "+b);k.delegate(":input","keydown",function(a){if(h.isAnyShortcutInEvent(a,d)){c();a.preventDefault()}})}})});a.KeyboardShortcuts.ready=true}});typeof e.contextPath()!=="undefined"&&f.trigger("initialize.keyboardshortcuts")}},
keyboardShortcuts:{Editor:[],enabled:false,ready:false,dialog:null,closeDialog:function(){a.KeyboardShortcuts.getDialog().then(function(a){a.hide()});return false},openDialog:function(){c(this).removeClass("interactive");a.KeyboardShortcuts.getDialog().then(function(a){a.show()});return false}}};k._logic=h;return k});
require("confluence/module-exporter").safeRequire("confluence-keyboard-shortcuts/confluence-keyboard-shortcuts",function(e){var c=require("confluence/legacy"),a=require("ajs");c.KeyboardShortcuts=e.keyboardShortcuts;a.toInit(e.init)});