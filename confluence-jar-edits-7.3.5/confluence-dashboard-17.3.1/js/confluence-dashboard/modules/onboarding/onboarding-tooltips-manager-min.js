define("confluence-dashboard/modules/onboarding/onboarding-tooltips-manager",["module","exports","marionette","confluence-dashboard/soy-templates","./onboarding-tooltip-view","underscore","configuration","../../utils/feature-discovery","../../utils/event-manager","window"],function(e,t,i,s,n,o,r,a,p,u){"use strict";var d=i.Object,l=b(s).default,c=b(n).default,f=b(o).default,h=r.pluginKey,v=b(a).default,g=p.ReqRes,m=b(u).default;function b(e){return e&&e.__esModule?e:{default:e}}t.default=d.extend({initialize:function(){m.require(["aui/inline-dialog2"]),g.request("app").expandSidebar(),this.featureDiscovery=v.forPlugin(h)},getTooltipDefinitions:function(e){return[{element:".sidebar-discover",tipId:"tour-step-sidebar",template:l.Onboarding[e.isNew?"newUserStep1":"existingUserStep1"]},{element:".sidebar-spaces",tipId:"tour-step-favourite-spaces",template:l.Onboarding[e.isNew?"newUserStep2":"existingUserStep2"]}]},showTips:function(e){var t=this.getTooltipDefinitions(e);this.createSteps(t)},createSteps:function(e){var t=this;return!!e&&(!!this.featureDiscovery.canShow("tips")&&(this.steps=[],f.each(e,function(e){t.featureDiscovery.canShow(e.tipId)&&t.steps.push(t.createTooltip(e))}),void this.openFirst()))},createTooltip:function(e){var t=new c({tipId:e.tipId,placedNextTo:e.element,template:e.template,templateHelpers:{id:e.tipId}});return this.listenTo(t,"skip",this.onSkip),this.listenTo(t,"next",this.onNext),t},openFirst:function(){0<this.steps.length&&this.steps[0].open()},onSkip:function(){this.featureDiscovery.markDiscovered("tips"),f.invoke(this.steps,"destroy"),this.destroy()},onNext:function(e){var t=this.steps.indexOf(e);this.steps.splice(t,1),this.openFirst()}}),e.exports=t.default});