define("confluence-editor/tinymce3/plugins/autocomplete-media/autocomplete-settings-media","jquery ajs confluence-editor/utils/attachments-insert-utils confluence/legacy tinymce confluence/macro-js-overrides".split(" "),function(k,d,l,f,h,i){return function(){var j=function(c){var b=d.params.attachmentSourceContentId||d.Meta.get("content-id");return c?d.contextPath()+"/rest/prototype/1/search.json":+b?d.contextPath()+"/rest/prototype/1/content/"+b+"/attachments.json":null},m=function(c,b){var a=d.MacroBrowser.getMacroMetadata("view-file")?
[]:["image","word","excel","pdf","powerpoint","multimedia"];return b?{type:"attachment",attachmentType:a,search:"name","max-results":c.maxResults,query:b}:{attachmentType:a,"max-results":c.maxResults}};f.Editor.Autocompleter.Settings["!"]={ch:"!",cache:false,endChars:["!"],dropDownClassName:"autocomplete-media",selectFirstItem:true,getHeaderText:function(){return d.MacroBrowser.getMacroMetadata("view-file")?d.I18n.getText("editor.autocomplete.file.header.text"):d.I18n.getText("editor.autocomplete.media.header.text")},
getAdditionalLinks:function(){var c=d.I18n.getText("editor.autocomplete.media.files.dialog.browse");return[{className:"dropdown-insert-image",html:f.Editor.Autocompleter.Util.dropdownLink(c,"dropdown-prevent-highlight","editor-icon"),callback:function(b){b.replaceWithSelectedSearchText();f.Editor.defaultInsertImageDialog()}},{className:"dropdown-insert-macro",html:f.Editor.Autocompleter.Util.dropdownLink(d.I18n.getText("editor.autocomplete.media.macros.dialog.browse"),"dropdown-prevent-highlight",
"editor-icon"),callback:function(b){b.replaceWithSelectedSearchText();h.confluence.macrobrowser.macroBrowserToolbarButtonClicked({selectedCategory:"media"})}}]},getDataAndRunCallback:function(c,b,a){f.Editor.Autocompleter.Util.getRestData(c,j,m,b,a,"attachment")},update:function(c,b){d.trigger("rte-autocomplete-on-insert",{triggerChar:"!",selectedFile:b});var a=b.restObj,e=d.REST.wikiLink(a),f=a&&a.title||b.name;if(a.niceType=="Image"){e.destination&&e.destination.replace(/^\^/,"");a=k.extend({filename:f,
contentId:b.ownerId||a.ownerId},e.params);h.confluence.ImageUtils.insertFromProperties(a)}else{var i=!!d.MacroBrowser.getMacroMetadata("view-file"),g=a.contentType,j=d.Meta.get("confluence-flavour")!=="VANILLA";i&&(j&&!(g&&g==="application/x-shockwave-flash")||g&&(g==="audio/mp3"||g==="video/mp4")||a.niceType!=="Multimedia")?l.insertFilePlaceholder({name:f,page:a.parentTitle,space:a.space?a.space.key:"",date:a.datePath,ownerId:a.ownerId}):this._insertFile(f,b,e)}},_insertFile:function(c,b,a){var e;
switch(b.restObj.niceType){case "PDF Document":e="viewpdf";break;case "Word Document":e="viewdoc";break;case "Excel Spreadsheet":e="viewxls";break;case "PowerPoint Presentation":e="viewppt";break;case "Multimedia":e="multimedia"}c={page:a.destination.substring(0,a.destination.indexOf("^")),name:c};i.get("viewdoc").beforeParamsRetrieved(c);c.page||delete c.page;e={contentId:d.Meta.get("content-id")||"0",macro:{name:e,params:c,body:""}};h.confluence.MacroUtils.insertMacro(e)}}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/autocomplete-media/autocomplete-settings-media");