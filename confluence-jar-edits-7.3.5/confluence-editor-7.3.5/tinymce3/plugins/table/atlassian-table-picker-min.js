define("confluence-editor/tinymce3/plugins/table/atlassian-table-picker",["ajs","tinymce","jquery","document"],function(c,F,g,O){function G(){e.css({top:g("#insert-table-dropdown").outerHeight(!0)});G=function(){}}function q(){if(!e.hasClass("hidden")){var a=g(c.Rte.getEditor().getDoc());j.unbind(".atlassian-table-picker");a.unbind(".atlassian-table-picker");e.addClass("hidden");r.addClass("hidden");z.removeClass("active")}}function H(a,b){c.debugEnabled()&&c.debug("setSize("+[a,b]+")");a==i&&b==
s||(a=Math.max(1,Math.min(I,a)),b=Math.max(1,Math.min(J,b)),m=Math.max(P,a),t=Math.max(Q,b),i=a,s=b,u.width(m*k+1),u.height(t*l+R),v(n,m,t),v(A,i,s),v(B,m,1),v(w,i,1),K(),L.text(i+" x "+s))}function K(){B.toggleClass("hidden",!h);w.toggleClass("hidden",!h)}function v(a,b,c){a.width(k*b+1);a.height(l*c+1)}function S(a){var b=n.offset(),d=b.top-j.scrollTop(),g=b.left-j.scrollLeft(),b=d+n.outerHeight(!0)+x,e=b-l-x,h=g+n.outerWidth(!0)+x,i=h-k-x,f=a.clientY,o=a.clientX,a=m,p=t;c.debugEnabled()&&c.debug("[mouseX,spLeft,spRightShrink,spRightGrow][mouseY,spTop,spBottomShrink,spBottomGrow] = "+
[o,g,i,h]+"/"+[f,d,e,b]);o>h?(d=~~((o-h)/k+1),a+=d,c.debugEnabled()&&c.debug("grow: xdelta = "+d)):o<i&&(d=~~((o-i)/k-1),a+=d,c.debugEnabled()&&c.debug("shrink: xdelta = "+d));f>b?(d=~~((f-b)/l+1),p+=d,c.debugEnabled()&&c.debug("grow: ydelta = "+d)):f<e&&(d=~~((f-e)/l-1),p+=d,c.debugEnabled()&&c.debug("shrink: ydelta = "+d));H(a,p)}function C(a){var b;b=~~(~~(a.offsetX||a.originalEvent.layerX)/k)+1;var d=~~(~~(a.offsetY||a.originalEvent.layerY)/l)+1;b=1>b||b>I||1>d||d>J?null:{width:b,height:d};a.preventDefault();
c.debug("insertTable: size = "+(b&&[b.width,b.height]));if(b){q();a=b.width;d=b.height;b=h;var e,f;c.debugEnabled()&&c.debug("shamefulInsertTable("+a+","+d+","+b+")");e=g("#tinymce-table-form");e.length?(e.find('input[name="rows"]').val(d),e.find('input[name="cols"]').val(a)):(a=c.renderTemplate("tableForm",d,a),f=g("<div></div>").addClass("hidden"),f.append(a),M.append(f));g("#table-heading-checkbox").prop("checked",b);c.Rte.BookmarkManager.restoreBookmark();F.activeEditor.undoManager.beforeChange();
F.activeEditor.plugins.table.insertTable();f&&f.remove()}}function y(a){c.debugEnabled()&&c.debug("key: "+a.charCode+"/"+a.keyCode+"/"+a.shiftKey);c.debug("key: "+a.charCode+"/"+a.keyCode+"/"+a.shiftKey);if(0===a.charCode){var b=!a.shiftKey;c.debugEnabled()&&c.debug("enableHeading("+b+")");b!=h&&(h=b,K())}27===a.keyCode&&0===a.charCode&&q()}function T(){q()}var N={},j,M,r,f,D,z,e,u,n,B,A,w,L,P=4,Q=4,I=15,J=20,k=25,l=17,R=20,x=0,m,t,i,s,h,E=!1;N.insertTable=C;return{bindToControl:function(){c.debugEnabled()&&
c.debug("Table Picker - bind to control");j=g(O);M=j.find("body");f=g("#insert-table-dropdown");D=g("#rte-button-insert-table");z=f.find(".aui-dd-parent");e=g("#table-picker-container");u=e.find(".table-picker-box");n=e.find(".picker-cell");B=e.find(".picker-heading");A=e.find(".picker-selected-cell");w=e.find(".picker-selected-heading");L=u.find(".desc");r=g("<div></div>").attr("id","table-picker-backdrop").addClass("hidden").appendTo(f);D.click(function(a){a.preventDefault();E||(c.Rte.BookmarkManager.storeBookmark(),
G(),h=!0,H(1,1),a=g(c.Rte.getEditor().getDoc()),j.bind("mousemove.atlassian-table-picker",S),j.bind("keydown.atlassian-table-picker",y),j.bind("keyup.atlassian-table-picker",y),a.bind("keydown.atlassian-table-picker",y),a.bind("keyup.atlassian-table-picker",y),r.removeClass("hidden"),e.removeClass("hidden"),z.addClass("active"),D.focus())});r.click(T);A.click(C);w.click(C)},disable:function(){E=!0;f.addClass("disabled")},enable:function(){E=!1;f.removeClass("disabled")},close:q,_internal:N}});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/tinymce3/plugins/table/atlassian-table-picker","AJS.Rte.TablePicker");