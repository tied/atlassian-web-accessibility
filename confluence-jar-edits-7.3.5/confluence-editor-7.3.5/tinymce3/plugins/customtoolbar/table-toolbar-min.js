define("confluence-editor/tinymce3/plugins/customtoolbar/table-toolbar",["ajs","jquery","confluence/legacy","tinymce","document"],function(g,d,b,c,h){return{initContextToolbars:function(x,e){function k(b){var a=d(this),c=d("#table-highlight-group"),f=c.attr("data-highlight-colour"),g=c.attr("data-remove-highlight");f&&(c.removeClass("highlight-"+f),c.removeAttr("data-highlight-colour"));c.removeClass("remove-highlight");g&&c.removeAttr("data-remove-highlight");if(f=a.attr("data-highlight-colour"))c.addClass("highlight-"+
f),c.attr("data-highlight-colour",f);a.attr("data-remove-highlight")&&(c.addClass("remove-highlight"),c.attr("data-remove-highlight",!0));e.focus();e.execCommand("confTableSelectionToggleHighlight",!1,{alwaysHighlight:!0});b.preventDefault()}var j,a=function(b){var a=e.getLang(b);(b=e.getLang(b+"_shortcut",""))&&(a+=" ("+b+")");return a},l=g.storageManager("atlassian.editor","tables");e.onNodeChange.add(function(a,c,i){a=d("body");a=!a.hasClass("no-tools")||a.hasClass("no-tools-toolbars-visible");
!j&&(null!=i.parentNode&&"BODY"!==i.nodeName)&&(j=!0,d(i).closest("table:not(.wysiwyg-macro)").length?(d(h).trigger("createContextToolbarRow.Toolbar",{buttons:b.Editor.tableToolbar.Buttons,topToolbar:!0,animate:a}).trigger("enableContextToolbarRow.Toolbar"),d.fn.updateTableModeInToolbar&&d(i).closest("table").updateTableModeInToolbar(),a=d(i).closest("td,th"),c=d(".mceSelected",a.closest("table")),1<=a.add(c).filter(function(){var a=d(this);return 1<parseInt(a.attr("rowspan"),10)||1<parseInt(a.attr("colspan"),
10)}).length?e.plugins.customtoolbar.enableToolbarButton("aui-iconfont-table-split"):e.plugins.customtoolbar.disableToolbarButton("aui-iconfont-table-split"),0<d(i).closest("table").find(".numberingColumn").length?d("#insert-numbering-column").addClass("active"):d("#insert-numbering-column").removeClass("active")):d(h).trigger("disableContextToolbarRow.Toolbar",{animate:a}),j=!1)});e.onUndo.add(function(a){a.nodeChanged()});e.onInit.add(function(){d(h).delegate("#table-highlight-colour .aui-dropdown a",
"click",k)});e.onRemove.add(function(){d(h).undelegate("#table-highlight-colour .aui-dropdown a","click",k)});var o=b.Editor,p=new b.Editor.Toolbar.Components.Group([new b.Editor.Toolbar.Components.Button({text:a("table.row_before_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-insert-row-before",click:function(){c.execCommand("mceTableInsertRowBefore",!1,"")}}),new b.Editor.Toolbar.Components.Button({text:a("table.row_after_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-insert-row-after",
click:function(){c.execCommand("mceTableInsertRowAfter",!1,"")}}),new b.Editor.Toolbar.Components.Button({text:a("table.delete_row_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-remove-row",click:function(){c.execCommand("mceTableDeleteRow",!1,"")}})]),q=new b.Editor.Toolbar.Components.Group([new b.Editor.Toolbar.Components.Button({text:a("table.cut_row_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-cut-table-row",click:function(){c.execCommand("mceTableCutRow",!1,"");e.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),
new b.Editor.Toolbar.Components.Button({text:a("table.copy_row_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-copy-table-row",click:function(){c.execCommand("mceTableCopyRow",!1,"");e.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-row")}}),new b.Editor.Toolbar.Components.Button({text:a("table.paste_row_before_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-paste-table-row",click:function(){c.execCommand("mceTablePasteRowBefore",!1,"")},disabled:!l.doesContain("copied")})]),
r=new b.Editor.Toolbar.Components.Group([new b.Editor.Toolbar.Components.Button({text:a("table.col_before_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-insert-column-before",click:function(){c.execCommand("mceTableInsertColBefore",!1,"")}}),new b.Editor.Toolbar.Components.Button({text:a("table.col_after_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-insert-column-after",click:function(){c.execCommand("mceTableInsertColAfter",!1,"")}}),new b.Editor.Toolbar.Components.Button({text:a("table.delete_col_desc"),
iconClass:"aui-icon aui-icon-small aui-iconfont-remove-column",click:function(){c.execCommand("mceTableDeleteCol",!1,"")}})]),s=new b.Editor.Toolbar.Components.Group([new b.Editor.Toolbar.Components.Button({text:a("table.merge_cells_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-merge-table-cells",click:function(){c.execCommand("mceTableMergeCells",!1,"")}}),new b.Editor.Toolbar.Components.Button({text:a("table.split_cells_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-split-merged-table-cells",
click:function(){c.execCommand("mceTableSplitCells",!1,"")}})]),t=new b.Editor.Toolbar.Components.Group([new b.Editor.Toolbar.Components.Button({text:a("table.row_highlight"),iconClass:"aui-icon aui-icon-small aui-iconfont-heading-row",click:function(){c.execCommand("confTableRowToggleHeading",!1);c.execCommand("mceTableUpdateNumberingCol",!1)}}),new b.Editor.Toolbar.Components.Button({text:a("table.col_highlight"),iconClass:"aui-icon aui-icon-small aui-iconfont-heading-column",click:function(){c.execCommand("confTableColumnToggleHeading",
!1)}}),new b.Editor.Toolbar.Components.Button({text:a("table.numbering_column_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-insert-numbered-column",id:"insert-numbering-column",click:function(){c.execCommand("mceTableInsertNumberingCol",!1,"")}})]),u=b.Editor.Toolbar.Components.SplitGroup,v=[new b.Editor.Toolbar.Components.Button({text:a("table.selection_highlight"),iconClass:"aui-icon aui-icon-small aui-iconfont-paint-bucket",click:function(){c.execCommand("confTableSelectionToggleHighlight",
!1)}})],m=d("<ul/>").addClass("table-highlight-picker"),n=[a("table.cell_color_grey"),a("table.cell_color_red"),a("table.cell_color_green"),a("table.cell_color_blue"),a("table.cell_color_yellow"),a("table.cell_color_clear")],w=[!1,!1,!1,!1,!1,!0];d.each("grey red green blue yellow ".split(" "),function(a,b){var c=d("<li/>"),f=d('<a href="#"></a>');w[a]?f.addClass("remove-highlight").attr("data-remove-highlight",true):f.addClass("highlight-"+b).attr("data-highlight-colour",b);f.attr("title",n[a]);
f.attr("aria-label",n[a]);f.tooltip();c.append(f);m.append(c)});o.tableToolbar={Buttons:[p,q,r,s,t,new u(v,{id:"table-highlight-group",dropDownOptions:{id:"table-highlight-colour",dropDownContent:m,alignment:"right"},postProcess:function(a){a.attr("data-highlight-colour","grey");a.addClass("highlight-grey");var b=d("<span>&nbsp;</span>");b.addClass("highlight-indicator");a.find(".icon.aui-iconfont-paint-bucket").after(b)}}),new b.Editor.Toolbar.Components.Group([new b.Editor.Toolbar.Components.Button({text:a("table.del"),
iconClass:"aui-icon aui-icon-small aui-iconfont-remove-table",click:function(){c.execCommand("mceTableDelete",!1,"")}})])],Events:[]};b.Editor.tableToolbar.Buttons.splice(0,0,new b.Editor.Toolbar.Components.Group([new b.Editor.Toolbar.Components.DropDownButton({id:"table-mode-picker",text:a("table.auto_width"),dropDownContent:function(){var b=d("<ul/>").addClass("table-mode-list"),e=[{name:a("table.responsive"),mceCmd:"mceAutoWidth",tooltip:a("table.responsive_tooltip")},{name:a("table.fixed_width"),
mceCmd:"mceFixedWidth",tooltip:a("table.fixed_width_tooltip")}];d.each(e,function(a,e){var g=d("<li/>").addClass("dropdown-item").attr("data-tooltip",e.tooltip),h=d('<a href="#">'+e.name+"</a>").addClass("item-link");g.on("click",function(){c.execCommand(e.mceCmd,!1,"")});b.append(g.append(h))});return b}()})]));g.DarkFeatures.isEnabled("confluence-table-enhancements.copy-cut-paste-cols.disabled")||b.Editor.tableToolbar.Buttons.splice(3,0,new b.Editor.Toolbar.Components.Group([new b.Editor.Toolbar.Components.Button({text:a("table.col_cut_desc"),
iconClass:"aui-icon aui-icon-small aui-iconfont-cut-table-column",click:function(){c.execCommand("mceTableCutCol",!1,"");e.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new b.Editor.Toolbar.Components.Button({text:a("table.col_copy_desc"),iconClass:"aui-icon aui-icon-small aui-iconfont-copy-table-column",click:function(){c.execCommand("mceTableCopyCol",!1,"");e.plugins.customtoolbar.enableToolbarButton("aui-iconfont-paste-table-column")}}),new b.Editor.Toolbar.Components.Button({text:a("table.col_paste_desc"),
iconClass:"aui-icon aui-icon-small aui-iconfont-paste-table-column",click:function(){c.execCommand("mceTablePasteColBefore",!1,"")},disabled:!l.doesContain("copied")})]))}}});require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/customtoolbar/table-toolbar",function(g){var d=require("jquery"),b=require("document");d(b).bind("initContextToolbars.Toolbar",g.initContextToolbars)});