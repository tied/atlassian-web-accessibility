define("confluence-editor/tinymce3/plugins/propertypanel/editor_plugin_src",["jquery","ajs","document","tinymce"],function(e,c,k,j){var h=[];c.bind("add-handler.property-panel",function(c,e){e&&h.push(e)});return{init:function(d){c.debug("init property panel plugin");var f,g=function(b,a,d){var f={focusedEl:d,focusedNodeName:d.nodeName&&d.nodeName.toLowerCase(),ed:b,e:e.extend({},a)};b=e(d);b.is("img")?b=b[0]:(b=b.closest("a,table,.wysiwyg-macro,.editor-inline-macro,.text-placeholder"),b=b.length?
b[0]:"");var d=!!e(d).closest("table:not(.wysiwyg-macro,.editor-inline-macro)").length,g=!!e(".toolbar-contextual").length;f.containerEl=b;c.trigger("user-blurred-rte-element",f);var i;if(i=b)a="click"!=a.type?!1:a.which?3===a.which:a.button?2==a.button:void 0,i=!a&&!c.Confluence.PropertyPanel.current&&c.Confluence.PropertyPanel.shouldCreate;if(i){a=0;for(i=h.length;a<i;a++)if(h[a].canHandleElement(e(b))){if(g||!d)return h[a].handle(f);(function(a){e(k).bind("shown.contextToolbar",function(){a.handle(f)})})(h[a])}}};
j.isIE&&d.onMouseDown.add(function(b,a){f&&f.unbind("mouseup.IEDragHandlesWorkaround");f=e(a.target);f.filter("img, table").bind("mouseup.IEDragHandlesWorkaround",function(){g(b,a,a.target)})});c.bind("trigger.property-panel",function(b,a){g(d,b,a.elem)});d.onClick.add(function(b,a){g(b,a,a.target)});d.onKeyUp.addToTop(function(b,a){27!==a.keyCode&&g(b,a,b.selection.getNode())});d.onContextMenu.add(function(){c.Confluence.PropertyPanel.destroy()});c.bind("user-blurred-rte-element",function(b,a){c.Confluence.PropertyPanel.current&&
(!a.containerEl||c.Confluence.PropertyPanel.current.hasAnchorChanged(a.containerEl)?c.Confluence.PropertyPanel.destroy():c.trigger("same-anchor.property-panel"))});c.bind("created.property-panel",function(){setTimeout(function(){c.Rte.bindScroll("property-panel",function(){c.Confluence.PropertyPanel.destroy()})},0);e(d.getDoc()).bind("keydown.property-panel.escape",function(b){27===b.keyCode&&c.Confluence.PropertyPanel.current&&c.Confluence.PropertyPanel.destroy()})});c.bind("destroyed.property-panel",
function(){c.Rte.unbindScroll("property-panel");e(d.getDoc()).unbind("keydown.property-panel.escape")})},getInfo:function(){return{longname:"Image, Link and Macro Property Panels",author:"Atlassian",authorurl:"http://www.atlassian.com",version:j.majorVersion+"."+j.minorVersion}}}});
require("confluence/module-exporter").safeRequire("confluence-editor/tinymce3/plugins/propertypanel/editor_plugin_src",function(e){var c=require("tinymce");c.create("tinymce.plugins.PropertyPanel",e);c.PluginManager.add("propertypanel",c.plugins.PropertyPanel)});