define("office-connector/edit-in-office-plugin",["jquery","ajs","office-connector/edit-in-office"],function(g,c,h){var f=function(i){i.on("fv.showFile fv.showFileError",function(j){var k=j.get("name");if(!k){throw new Error('Office connector expects the "name" property to be passed by the file viewer')}if(j&&b(k)&&a()){i.addFileAction({key:"edit-in-office",text:c.I18n.getText("office.connector.attachment.edit"),callback:d})}})};var a=function(){return c.Meta.get("content-type")==="page"||c.Meta.get("content-type")==="blogpost"};var b=function(j){var i=(h.getProgID(j)!=="");return i&&(e())};var e=function(){var i,j=(window.ActiveXObject!==undefined);if(j){try{i=new ActiveXObject("SharePoint.OpenDocuments.1")}catch(k){}}return i};var d=function(i){var k=i.get("attachmentId")||i.get("id");var j=c.contextPath();g.getJSON(j+"/rest/office/1.0/metadata/"+k).done(function(n){var o=j+n.webDavUrl;var m=n.usePathAuth;var l=getProgID(o);return h.doEditInOffice(j,o,l,m)})};return f});var FileViewer=require("FileViewer");var EditInOfficePlugin=require("office-connector/edit-in-office-plugin");FileViewer.registerPlugin("editInOffice",EditInOfficePlugin);