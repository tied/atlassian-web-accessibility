define("confluence-collaborative-editor-plugin/avatar-view",["backbone","ajs","confluence/templates","jquery"],function(d,a,b,c){return d.View.extend({initialize:function(){this.model.on("remove",this.remove,this)},render:function(){this.$el=c(b.SynchronyPresence.avatar({title:this._determineTitle(),initial:this.model.get("fullname").charAt(0).toUpperCase(),fullname:this.model.get("fullname"),username:this.model.get("username"),avatarUrl:this.model.get("avatarURL"),origin:this.model.get("origin"),active:this.model.get("active"),currentUser:this.model.get("currentUser"),telepointer:this._synchronyTelepointerId()}));return this.$el},remove:function(){this.$el.removeClass().addClass("avatar-item animate");if(!this.model.get("hidden")){this.$el.addClass("removing")}this.$el.one(this._getSupportedTransition(),function(){c(this).removeClass("animate removing");c(this).remove()})},_determineTitle:function(){if(this.model.get("currentUser")){var e=[a.I18n.getText("collab.presence.avatar.you.1"),a.I18n.getText("collab.presence.avatar.you.2")];return e[Math.floor(Math.random()*e.length)]}return this.model.get("fullname")+" "+(this.model.get("active")?a.I18n.getText("collab.presence.avatar.editing"):a.I18n.getText("collab.presence.avatar.historical"))},_getSupportedTransition:function(){var g={transition:"transitionend",MozTransition:"transitionend",OTransition:"oTransitionEnd",MsTransition:"msTransitionEnd",WebkitTransition:"webkitTransitionEnd"};var e=document.createElement("_");for(var f in g){if(e.style[f]!==undefined){return g[f]}}},_synchronyTelepointerId:function(){var g=""+(this.model.get("sub")||this.model.get("origin")||"");var f=0;for(var e=0;e<g.length;e++){f=((f<<5)-f)+g.charCodeAt(e);f=f&f}return(Math.abs(f)%10)}})});