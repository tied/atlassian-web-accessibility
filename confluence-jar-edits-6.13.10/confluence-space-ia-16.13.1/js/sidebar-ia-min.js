AJS.$,Confluence.Sidebar={},AJS.toInit(function(e){var t=e(window),i=e(document),a=Math.min(285,t.width()/3),o=285,n=150,l=55,s=640,r=AJS.storageManager("confluence","sidebar"),d="width",c=AJS.contextPath(),p=AJS.Meta.get("space-key"),u=AJS.Meta.get("use-keyboard-shortcuts")?" "+AJS.I18n.getText("sidebar.splitter.shortcut.help"):"";Confluence.Sidebar.collapseTooltip=AJS.I18n.getText("sidebar.splitter.collapse.help")+u,Confluence.Sidebar.expandTooltip=AJS.I18n.getText("sidebar.splitter.expand.help")+u;var f=e(".ia-splitter").children(),g=e(".ia-splitter-left");if(!(g.length<1)){var b=e(".acs-side-bar"),h=g.find(".ia-fixed-sidebar"),v=e("<div>",{class:"ia-splitter-handle tipsy-enabled","data-tooltip":Confluence.Sidebar.collapseTooltip}).appendTo(h);e("<div>",{class:"ia-splitter-handle-highlight confluence-icon-grab-handle"}).appendTo(v);var m,C=e(".ia-secondary-container"),S=e("#footer, #studio-footer");Confluence.Sidebar.throbberDiv=function(){var t=e(Confluence.Templates.Sidebar.throbber()),i=t.find(".spinner"),a=Raphael.spinner(i[0],10,"#666");return t.find(".throbber").bind("remove",function(){a()}),t},C.length&&("blogs"===(m=C.attr("data-tree-type"))?function(t,i){t.delegate(".acs-tree-item > .icon, .acs-tree-item > .node-title","click",function(){var t=e(this),a=t.parent(),o=a.find("> .icon");if(a.hasClass("opened"))a.children("ul").hide(),a.removeClass("opened").addClass("closed"),o.removeClass("aui-iconfont-expanded").addClass("aui-iconfont-collapsed");else if(a.hasClass("closed")){var n=a.children("ul");if(n.length)n.show();else{var l=e(Confluence.Templates.Sidebar.treeThrobber());a.append(l),i(a,function(t){var i=e(Confluence.Templates.Sidebar.pagetreeList({pagetree:t,isSubtree:!0}));l.remove(),i.appendTo(a)})}a.removeClass("closed").addClass("opened"),o.removeClass("aui-iconfont-collapsed").addClass("aui-iconfont-expanded")}})}(b,A):"pages"===m&&Confluence.Sidebar.Pages.installHandlers(b)),t.scroll(J),t.resize(J),t.on("touchend",J),i.ready(J),AJS.bind("confluence.header-resized",J),e("#header-precursor img").load(J),Confluence.Sidebar.applyTooltip=w,T(),AJS.bind("sidebar.exit-configure-mode",T);var y=r.getItem(d)||a;k(y>n?y:l),i.on("mousewheel",".ia-scrollable-section",function(t,i){var a=e(this).scrollTop(),o=e(this).get(0).scrollHeight-e(this).innerHeight()-1;i>0&&a<=0||i<0&&a>=o?t.preventDefault():e.browser.msie&&(t.preventDefault(),e(this).scrollTop(a+-1*i*30)),t.stopPropagation()}),h.css("visibility","visible"),J(),function(){var t=e("body"),i=!1;function s(){if(!Confluence.Sidebar.Configure.mode){var e=h.width();e>l?e<=n?k(a=o):(a=e,k(l)):k(a)}}v.on("mousedown.ia-splitter",function(e){!function(e){e.preventDefault(),f.one("selectstart",function(e){e.preventDefault()}),i=!1,t.on("mousemove.ia-splitter",function(e){Confluence.Sidebar.Configure.mode&&e.pageX<o||(k(e.pageX),i=!0)}),t.one("mouseup mouseleave",function(){h.width()<=n?k(l):a=h.width(),t.off("mousemove.ia-splitter")})}(e),x()}).click(function(){i?i=!1:s()}),Confluence.Sidebar.toggle=s}(),setTimeout(function(){Confluence.Sidebar.createFlyouts(b)},0),AJS.trigger("sidebar.finished-loading"),t.one("pagetree-children-loaded",function(){var t=e(".plugin_pagetree_current");if(t.length){var i=t.offset();i.top>b.height()/2&&b.scrollTop(i.top-b.height()/3),i.left>b.width()/2&&b.scrollLeft(i.left-b.width()/2)}}),AJS.bind("sidebar.enter-configure-mode",function(){x(),h.width()<o&&(Confluence.Sidebar.widthBeforeConfiguring=h.width(),k(o)),h.addClass("configure-mode")}),AJS.bind("sidebar.exit-configure-mode",function(){x(),Confluence.Sidebar.widthBeforeConfiguring&&(k(Confluence.Sidebar.widthBeforeConfiguring),Confluence.Sidebar.widthBeforeConfiguring=void 0),h.removeClass("configure-mode")}),e(function(){e(".expand-collapse-trigger").keypress(function(e){13==e.keyCode&&Confluence.Sidebar.toggle()})}),e("div.ia-fixed-sidebar.collapsed .space-logo a").focusin(function(){Confluence.Sidebar.toggle()})}function x(){AJS.trigger("sidebar.hide-overlays")}function w(t,i){var a={live:!0,gravity:"w",title:"data-tooltip",delayIn:500,delayOut:0,offset:5};e(t).tooltip(i?e.extend(a,i):a)}function T(){function t(){e(".tipsy").remove()}e(".acs-side-bar .quick-links-section").attr("data-collapsed-tooltip",AJS.I18n.getText("sidebar.main.quick.links")),e("#space-tools-menu-trigger").attr("data-collapsed-tooltip",AJS.I18n.getText("sidebar.main.settings")),"pages"==C.attr("data-tree-type")&&(e(".acs-side-bar .ia-secondary-container").attr("data-collapsed-tooltip",AJS.I18n.getText("sidebar.pages.children")),w(".collapsed .ia-secondary-container.tipsy-enabled",{title:"data-collapsed-tooltip"})),w(".expand-collapse-trigger"),w(".ia-splitter-handle.tipsy-enabled"),w(".collapsed .quick-links-section.tipsy-enabled, .collapsed .acs-nav-item > a.tipsy-enabled, .collapsed #space-tools-menu-trigger.tipsy-enabled",{title:"data-collapsed-tooltip"}),w(".configure-mode .acs-side-bar-space-info.tipsy-enabled",{title:"data-configure-tooltip"}),b.on("mousedown click scroll",x),e(window).on("scroll resize",x),AJS.bind("sidebar.hide-overlays",t),AJS.bind("sidebar.disable-tooltip",function(i,a){var o=e(a).closest(".tipsy-enabled");if(1==o.size()){o.removeClass("tipsy-enabled").addClass("tipsy-disabled").attr("title","");var n=o.data("tipsy");n&&(n.hoverState="out"),t()}}),AJS.bind("sidebar.enable-all-tooltips",function(){e(".tipsy-disabled").removeClass("tipsy-disabled").addClass("tipsy-enabled")})}function A(t,i){var a=t.attr("data-group-type"),o=t.attr("data-group-value"),n=c+"/rest/ia/1.0/pagetree/blog/subtree";e.get(n,{spaceKey:p,groupType:a,groupValue:o}).done(i)}function J(){var a=g.offset().top,o=t.scrollTop(),n=t.scrollLeft();o<0||o>i.height()-t.height()||n<0||n>i.width()-t.width()||("fixed"!==e("#header").css("position")?h.css({top:Math.max(a-o,0)+"px",left:Math.min(-1*n,0)+"px"}):h.css({left:Math.min(-1*n,0)+"px"}))}function k(t){t=Math.max(t,l),t=Math.min(t,s),r.setItemQuietly(d,t),t<=n?(h.addClass("collapsed"),h.attr("aria-expanded","false"),e(".expand-collapse-trigger").removeClass("aui-iconfont-chevron-double-left").addClass("aui-iconfont-chevron-double-right"),v.attr("data-tooltip",Confluence.Sidebar.expandTooltip),AJS.trigger("sidebar.collapsed")):h.hasClass("collapsed")&&(h.removeClass("collapsed"),h.attr("aria-expanded","true"),v.attr("data-tooltip",Confluence.Sidebar.collapseTooltip),e(".expand-collapse-trigger").removeClass("aui-iconfont-chevron-double-right").addClass("aui-iconfont-chevron-double-left"),AJS.trigger("sidebar.expanded")),h.width(t),f.eq(1).css("margin-left",t+"px"),S.css("margin-left",h.outerWidth()+"px")}});